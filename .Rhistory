ret
runif(100)
range(runif(100))
x<-range(runif(100))
x[1]
x[2]
class(x)
length(x)
setwd("/Users/pvangay/Dropbox/UMN/KnightsLab/IMP/ANALYSES/analysis")
source("/Users/pvangay/Dropbox/UMN/KnightsLab/IMP/ANALYSES/analysis/lib/plot.alphadiv.r")
source("/Users/pvangay/Dropbox/UMN/KnightsLab/IMP/ANALYSES/analysis/lib/plot.relative.distance.r")
source("/Users/pvangay/Dropbox/UMN/KnightsLab/IMP/ANALYSES/analysis/lib/fraction.hits.r")
source("/Users/pvangay/Dropbox/UMN/KnightsLab/IMP/ANALYSES/analysis/lib/load.data.r")
source("/Users/pvangay/Dropbox/UMN/KnightsLab/IMP/ANALYSES/analysis/lib/plot.b.p.ratio.r")
source("/Users/pvangay/Dropbox/UMN/KnightsLab/IMP/ANALYSES/analysis/lib/plot.group.distances.r")
source("/Users/pvangay/Dropbox/UMN/KnightsLab/IMP/ANALYSES/analysis/lib/plot.nutrients.r")
source("/Users/pvangay/Dropbox/UMN/KnightsLab/IMP/ANALYSES/analysis/lib/plot.alphadiv.r")
source("/Users/pvangay/Dropbox/UMN/KnightsLab/IMP/ANALYSES/analysis/lib/plot.pcoa.r")
source("/Users/pvangay/Dropbox/UMN/KnightsLab/IMP/ANALYSES/analysis/lib/plot.body.trends.r")
source("/Users/pvangay/Dropbox/UMN/KnightsLab/IMP/ANALYSES/analysis/lib/predict.years.r")
datadir <- "/Users/pvangay/Dropbox/UMN/KnightsLab/IMP/ANALYSES/analysis/data"
otufn <- paste(datadir,"final_otu_L6.txt",sep="/")
# load data
wuf_dm <- read.table(paste(datadir, "weighted_unifrac_dm.txt",sep="/"), sep="\t", quote="", row=1, head=T)
uwuf_dm <- read.table(paste(datadir,"unweighted_unifrac_dm.txt",sep="/"), sep="\t", quote="", row=1, head=T)
bc_dm <- read.table(paste(datadir,"bray_curtis_dm.txt",sep="/"), sep="\t", quote="", row=1, head=T)
# let's try uwuf first
dm <- uwuf_dm
#dm <- wuf_dm
alphadiv0 <- read.table(paste(datadir,"alpha.txt",sep="/"), sep="\t", quote="", row=1, head=T, comment.char="")
# load mapping and otu/taxa file - automatically normalizes, filters, and merges
# let's turn off normalization efforts. The taxa file should already be in relative abundance.
ret <- load.data(mapfile=paste(datadir,"mapping.txt",sep="/"), otufile=otufn, normalize=F)
map <- ret$map
taxa <- ret$otu
# write out relative abundance OTU file out
# only work with samples that are in both the mapping AND the dm/alpha files
valid_samples <- intersect(rownames(dm), rownames(map))
map <- map[valid_samples,]
dm <- dm[valid_samples, valid_samples]
# required: refactor BMI.Class to order by BMI instead of alphabetical
map$BMI.Class <- factor(map$BMI.Class, levels=c("Normal", "Overweight", "Obese"))
# include 1st sample of longitudinal samples in any CS analyses
cs_samples <- rownames(map)[is.na(map$Sample.Order) | map$Sample.Order==1]
plot.relative.longitudinal(map = map[map$Sub.Study == "L" & map$Subject.ID != "IMP.000",], dm=uwuf_dm,
ref.sample = 6, xlab="Month in the US", outputfn="relative_L_uwuf.pdf")
plot.relative.longitudinal(map = map[map$Sub.Study == "L" & map$Subject.ID != "IMP.000",], dm=wuf_dm,
ref.sample = 6, xlab="Month in the US", outputfn="relative_L_wuf.pdf")
plot.relative.longitudinal(map = map[map$Sub.Study == "L" & map$Subject.ID != "IMP.000",], dm=bc_dm,
ref.sample = 6, xlab="Month in the US", outputfn="relative_L_bc.pdf")
# plot relative distance to self
plot.relative.longitudinal(map = map[map$Subject.ID == "IMP.000",], dm=uwuf_dm,
ref.sample.order = 21, xlab="Day", outputfn="relative_self_uwuf.pdf")
plot.relative.longitudinal(map = map[map$Subject.ID == "IMP.000",], dm=wuf_dm,
ref.sample.order = 21, xlab="Day", outputfn="relative_self_wuf.pdf")
plot.relative.longitudinal(map = map[map$Subject.ID == "IMP.000",], dm=bc_dm,
ref.sample.order = 21, xlab="Day", outputfn="relative_self_bc.pdf")
plot.relative.longitudinal(map = map[map$Sub.Study == "L" & map$Subject.ID != "IMP.000",], dm=uwuf_dm,
ref.sample = 1, xlab="Month in the US", outputfn="relative_L_uwuf.pdf")
plot.relative.longitudinal(map = map[map$Sub.Study == "L" & map$Subject.ID != "IMP.000",], dm=wuf_dm,
ref.sample = 1, xlab="Month in the US", outputfn="relative_L_wuf.pdf")
plot.relative.longitudinal(map = map[map$Sub.Study == "L" & map$Subject.ID != "IMP.000",], dm=bc_dm,
ref.sample = 1, xlab="Month in the US", outputfn="relative_L_bc.pdf")
# plot relative distance to self
plot.relative.longitudinal(map = map[map$Subject.ID == "IMP.000",], dm=uwuf_dm,
ref.sample.order = 1, xlab="Day", outputfn="relative_self_uwuf.pdf")
plot.relative.longitudinal(map = map[map$Subject.ID == "IMP.000",], dm=wuf_dm,
ref.sample.order = 1, xlab="Day", outputfn="relative_self_wuf.pdf")
plot.relative.longitudinal(map = map[map$Subject.ID == "IMP.000",], dm=bc_dm,
ref.sample.order = 1, xlab="Day", outputfn="relative_self_bc.pdf")
map[map$Subject.ID == "IMP.000",]
map[map$Subject.ID == "IMP.000",c("Sample.Order", "Sample.Date")]
source("/Users/pvangay/Dropbox/UMN/KnightsLab/IMP/ANALYSES/analysis/lib/plot.relative.distance.r")
plot.relative.longitudinal(map = map[map$Sub.Study == "L" & map$Subject.ID != "IMP.000",], dm=uwuf_dm,
ref_samples.order = 1, xlab="Month in the US", outputfn="Long_to_Thai_uwuf.pdf",
ref_samples=rownames(map)[map$Sample.Group == "KarenThai"])
plot.relative.longitudinal(map = map[map$Sub.Study == "L" & map$Subject.ID != "IMP.000",], dm=wuf_dm,
ref.sample.order = 1, xlab="Month in the US", outputfn="Long_to_Thai_wuf.pdf",
ref_samples=rownames(map)[map$Sample.Group == "KarenThai"])
plot.relative.longitudinal(map = map[map$Sub.Study == "L" & map$Subject.ID != "IMP.000",], dm=bc_dm,
ref.sample.order = 1, xlab="Month in the US", outputfn="Long_to_Thai_bc.pdf",
ref_samples=rownames(map)[map$Sample.Group == "KarenThai"])
source("/Users/pvangay/Dropbox/UMN/KnightsLab/IMP/ANALYSES/analysis/lib/plot.relative.distance.r")
plot.relative.longitudinal(map = map[map$Sub.Study == "L" & map$Subject.ID != "IMP.000",], dm=uwuf_dm,
ref_samples.order = 1, xlab="Month in the US", outputfn="Long_to_Thai_uwuf.pdf",
ref_samples=rownames(map)[map$Sample.Group == "KarenThai"])
plot.relative.longitudinal(map = map[map$Sub.Study == "L" & map$Subject.ID != "IMP.000",], dm=wuf_dm,
ref.sample.order = 1, xlab="Month in the US", outputfn="Long_to_Thai_wuf.pdf",
ref_samples=rownames(map)[map$Sample.Group == "KarenThai"])
plot.relative.longitudinal(map = map[map$Sub.Study == "L" & map$Subject.ID != "IMP.000",], dm=bc_dm,
ref.sample.order = 1, xlab="Month in the US", outputfn="Long_to_Thai_bc.pdf",
ref_samples=rownames(map)[map$Sample.Group == "KarenThai"])
length(NA)
length(NULL)
x <- 1:10
y <- 20:30
dm[1:5,1]
dm[1:5,2]
dm[1:5,3]
x3<-dm[1:5,3]
x2<-dm[1:5,2]
x1<-dm[1:5,1]
mean(c(x1,x2,x3()))
mean(c(x1,x2,x3))
mean(dm[1:5,1:3])
dm[1:5,1:3]
mean(as.numeric(dm[1:5,1:3]))
mean(as.numeric(dm[1:5,4:5]))
mean(as.numeric(dm[1:5,c("CS.003","CS.004")]))
dm[1:5,c("CS.003","CS.004")]
dm[1:5,6:7]
unlist(dm[1:5,6:7])
mean(unlist(dm[1:5,6:7]))
mean(as.numeric(dm[1:5,6:7]))
mean(as.numeric(dm[1,6:7]))
mean(as.numeric(dm[2,6:7]))
mean(as.numeric(dm[3,6:7]))
x1 <- mean(as.numeric(dm[1,6:7]))
x2 <- mean(as.numeric(dm[2,6:7]))
x3 <- mean(as.numeric(dm[3,6:7]))
x4 <- mean(as.numeric(dm[4,6:7]))
mean(c(x1,x2,x3,x4))
mean(unlist(dm[1:4,6:7]))
x1
source("/Users/pvangay/Dropbox/UMN/KnightsLab/IMP/ANALYSES/analysis/lib/plot.relative.distance.r")
plot.relative.longitudinal(map = map[map$Sub.Study == "L" & map$Subject.ID != "IMP.000",], dm=uwuf_dm,
ref_samples.order = 1, xlab="Month in the US", outputfn="Long_to_Thai_uwuf.pdf",
ref_samples=rownames(map)[map$Sample.Group == "KarenThai"])
plot.relative.longitudinal(map = map[map$Sub.Study == "L" & map$Subject.ID != "IMP.000",], dm=wuf_dm,
ref.sample.order = 1, xlab="Month in the US", outputfn="Long_to_Thai_wuf.pdf",
ref_samples=rownames(map)[map$Sample.Group == "KarenThai"])
plot.relative.longitudinal(map = map[map$Sub.Study == "L" & map$Subject.ID != "IMP.000",], dm=bc_dm,
ref.sample.order = 1, xlab="Month in the US", outputfn="Long_to_Thai_bc.pdf",
ref_samples=rownames(map)[map$Sample.Group == "KarenThai"])
plot.relative.longitudinal(map = map[map$Sub.Study == "L" & map$Subject.ID != "IMP.000",], dm=uwuf_dm,
ref.samples.order = 1, xlab="Month in the US", outputfn="Long_to_Thai_uwuf.pdf",
ref_samples=rownames(map)[map$Sample.Group == "KarenThai"])
plot.relative.longitudinal(map = map[map$Sub.Study == "L" & map$Subject.ID != "IMP.000",], dm=uwuf_dm,
ref.sample.order = 1, xlab="Month in the US", outputfn="Long_to_Thai_uwuf.pdf",
ref_samples=rownames(map)[map$Sample.Group == "KarenThai"])
karen_firstgen_cs <- rownames(map)[map$Ethnicity=="Karen" & (is.na(map$Sample.Order) | map$Sample.Order==1)]
karenthai <- rownames(map)[map$Sample.Group=="KarenThai"]
plot.relative.distance(map=map, dm=uwuf_dm, query_samples=karen_firstgen_cs, ref_samples=karenthai, filename="karen_relative_distance_uwuf.pdf")
plot.relative.distance(map=map, dm=wuf_dm, query_samples=karen_firstgen_cs, ref_samples=karenthai, filename="karen_relative_distance_wuf.pdf")
plot.relative.distance(map=map, dm=bc_dm, query_samples=karen_firstgen_cs, ref_samples=karenthai, filename="karen_relative_distance_bc.pdf")
hmong_firstgen_cs <- rownames(map)[map$Ethnicity=="Hmong" & (is.na(map$Sample.Order) | map$Sample.Order==1)]
plot.relative.distance(map=map, dm=uwuf_dm, query_samples=hmong_firstgen_cs, ref_samples=second_gen_cs, filename="hmong_relative_distance_uwuf.pdf")
plot.relative.distance(map=map, dm=wuf_dm, query_samples=hmong_firstgen_cs, ref_samples=second_gen_cs, filename="hmong_relative_distance_wuf.pdf")
plot.relative.distance(map=map, dm=bc_dm, query_samples=hmong_firstgen_cs, ref_samples=second_gen_cs, filename="hmong_relative_distance_bc.pdf")
second_gen_cs <- rownames(map)[map$Sample.Group == "Hmong2nd"]
plot.relative.distance(map=map, dm=uwuf_dm, query_samples=hmong_firstgen_cs, ref_samples=second_gen_cs, filename="hmong_relative_distance_uwuf.pdf")
plot.relative.distance(map=map, dm=wuf_dm, query_samples=hmong_firstgen_cs, ref_samples=second_gen_cs, filename="hmong_relative_distance_wuf.pdf")
plot.relative.distance(map=map, dm=bc_dm, query_samples=hmong_firstgen_cs, ref_samples=second_gen_cs, filename="hmong_relative_distance_bc.pdf")
plot.relative.distance(map=map, dm=uwuf_dm, query_samples=rownames(map)[map$Sample.Group == "Hmong1st"], ref_samples=second_gen_cs, filename="hmong_relative_distance_uwuf.pdf")
plot.relative.distance(map=map, dm=wuf_dm, query_samples=rownames(map)[map$Sample.Group == "Hmong1st"], ref_samples=second_gen_cs, filename="hmong_relative_distance_wuf.pdf")
plot.relative.distance(map=map, dm=bc_dm, query_samples=rownames(map)[map$Sample.Group == "Hmong1st"], ref_samples=second_gen_cs, filename="hmong_relative_distance_bc.pdf")
hmong_firstgen_cs <- rownames(map)[map$Sample.Group == "Hmong1st" & map$Subject.ID != "IMP.000"]
plot.relative.distance(map=map, dm=uwuf_dm, query_samples=hmong_firstgen_cs, ref_samples=second_gen_cs, filename="hmong_relative_distance_uwuf.pdf")
plot.relative.distance(map=map, dm=wuf_dm, query_samples=hmong_firstgen_cs, ref_samples=second_gen_cs, filename="hmong_relative_distance_wuf.pdf")
plot.relative.distance(map=map, dm=bc_dm, query_samples=hmong_firstgen_cs, ref_samples=second_gen_cs, filename="hmong_relative_distance_bc.pdf")
hmongthai <- rownames(map)[map$Sample.Group=="HmongThai"]
plot.relative.distance(map=map, dm=uwuf_dm, query_samples=hmong_firstgen_cs, ref_samples=hmongthai, filename="hmong_relative_distance_uwuf.pdf")
plot.relative.distance(map=map, dm=wuf_dm, query_samples=hmong_firstgen_cs, ref_samples=hmongthai, filename="hmong_relative_distance_wuf.pdf")
plot.relative.distance(map=map, dm=bc_dm, query_samples=hmong_firstgen_cs, ref_samples=hmongthai, filename="hmong_relative_distance_bc.pdf")
