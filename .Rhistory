ret
setwd("/Users/pvangay/Dropbox/UMN/KnightsLab/IMP/ANALYSES/analysis")
use.rare <- FALSE
# load all source files, data, and prep any variables for reuse
source("bin/load.r")
taxa_clr_L7_fn <- paste(datadir,"taxa.clr.L7.txt",sep="/")
taxa_clr_L6_fn <- paste(datadir,"taxa.clr.L6.txt",sep="/")
taxa_clr_L2_fn <- paste(datadir,"taxa.clr.L2.txt",sep="/")
taxa_clr_L7 <- load.data(mapfile, otufile=taxa_clr_L7_fn, normalize=F)$otu
taxa_clr_L6 <- load.data(mapfile, otufile=taxa_clr_L6_fn, normalize=F)$otu
taxa_clr_L2 <- load.data(mapfile, otufile=taxa_clr_L2_fn, normalize=F)$otu
debugSource('~/Dropbox/UMN/KnightsLab/IMP/ANALYSES/analysis/lib/utils.r')
query_samples_list <- list(c(hmong_secondgen_cs, hmong_firstgen_cs), c(hmong_secondgen_cs,hmong_firstgen_cs, karen_firstgen_cs), karen_firstgen_cs)
ref_samples_list <- list(hmongthai, c(hmongthai, karenthai), karenthai)
fn_ext <- c("Hmong", "All", "Karen")
for(i in 1:length(query_samples_list))
{
map_temp <- map[query_samples_list[[i]],]
map_temp <- map_temp[map_temp$BMI.Class %in% c("Lean","Obese"),]
new_query_samples <- rownames(map_temp)
# calculate the relative distances to reference groups as response variable
all.samples <- c(new_query_samples, ref_samples_list[[i]])
ddm <- vegdist(taxa_clr_L7[all.samples,], method="euc")
dm <- as.matrix(ddm)
rel.dist <- get.relative.distance(new_query_samples, ref_samples_list[[i]], dm)
multiplot.boxplot.by.group.x.bmi(map00=map_temp, y.list=list(rel.dist), ylabs="Distance to Thai Reference", mains="Euclidean", outputfn=paste0("boxplot-BMI-x-RelativeDistance-",fn_ext[i],"-CLR.pdf"))
}
m
this.y
query_samples_list <- list(c(hmong_secondgen_cs, hmong_firstgen_cs), c(hmong_secondgen_cs,hmong_firstgen_cs, karen_firstgen_cs), karen_firstgen_cs)
ref_samples_list <- list(hmongthai, c(hmongthai, karenthai), karenthai)
fn_ext <- c("Hmong", "All", "Karen")
for(i in 1:length(query_samples_list))
{
map_temp <- map[query_samples_list[[i]],]
map_temp <- map_temp[map_temp$BMI.Class %in% c("Lean","Obese"),]
new_query_samples <- rownames(map_temp)
# calculate the relative distances to reference groups as response variable
all.samples <- c(new_query_samples, ref_samples_list[[i]])
ddm <- vegdist(taxa_clr_L7[all.samples,], method="euc")
dm <- as.matrix(ddm)
rel.dist <- get.relative.distance(new_query_samples, ref_samples_list[[i]], dm)
multiplot.boxplot.by.group.x.bmi(map00=map_temp, y.list=list(rel.dist), ylabs="Distance to Thai Reference", mains="Euclidean", outputfn=paste0("boxplot-BMI-x-RelativeDistance-",fn_ext[i],"-CLR.pdf"))
}
this.y
