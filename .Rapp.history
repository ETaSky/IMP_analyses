m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)
m
summary(m)
dm <- uwuf_dmggmap <- read.table("/Users/pvangay/Dropbox/UMN/KnightsLab/IMP/Sequencing/sequences_090716/4. EMBALMER_output/Yatsunenko_global_gut_study_850_mapping_file.txt",    sep="\t", quote="", row=1, head=T, comment.char="")gg_females <- rownames(ggmap)[ggmap$SEX == "female" & as.numeric(as.character(ggmap$AGE)) > 16 & ggmap$AGE != "None"]map <- read.table("/Users/pvangay/Dropbox/UMN/KnightsLab/IMP/Sequencing/sequences_090716/4. EMBALMER_output/mapping_merged.txt",    sep="\t", quote="", row=1, head=T, comment.char="")map$Age <- as.numeric(as.character(map$Age))map$Years.in.US <- as.numeric(as.character(map$Years.in.US))# let's only work with samples that are in both the mapping AND the dm filesvalid_samples <- intersect(rownames(dm), rownames(map))map <- map[valid_samples,]dm <- dm[valid_samples, valid_samples]US_adults <- rownames(map)[map$Ethnicity=="GAZ:United States of America" & map$Age > 16 & !is.na(map$Age)]US_adults <- intersect(US_adults,gg_females)Malawi_adults <- rownames(map)[map$Ethnicity=="GAZ:Malawi" & map$Age > 16 & !is.na(map$Age)]Venezuelan_adults <- rownames(map)[map$Ethnicity=="GAZ:Venezuela" & map$Age > 16 & !is.na(map$Age)]imp_samples <- rownames(map)[map$Ethnicity %in% c("Hmong", "Karen")] # plot each Hmong and/or Karen sample against average of US_adults# for each Hmong, calc the average of it's distance to all americansIMP_to_US <- NULLfor (i in 1:length(imp_samples)){    IMP_to_US[i] <- mean(as.numeric(dm[imp_samples[i], US_adults]))}names(IMP_to_US) <- imp_samples#mean US adultsUS_to_US <- NULLfor (i in 1:length(US_adults)){    US_to_US[i] <- mean(as.numeric(dm[US_adults[i], US_adults[-i]]))}mean_data <- cbind(IMP_to_US, map[imp_samples, c("Years.in.US", "Ethnicity", "Age", "BMI","BMI.Class")])colnames(mean_data) <- c("Distance.to.US", "Years.in.US", "Ethnicity", "Age","BMI", "BMI.Class")# exclude older people?# let's reset Years in US for the US-born to -10 so we can see this mean_data$Years.in.US[mean_data$Years.in.US==0] <- -1lookup <- c(19,17) # point typenames(lookup) <- sort(unique(mean_data$Ethnicity)) # let's Hmong to solid filled circle, Karen to filled trianglefinal.pch <- lookup[as.character(mean_data$Ethnicity)] # cols <- c("yellow","blue","green")# names(cols) <- sort(unique(mean_data$BMI.Class))# final.cols <- cols[as.character(mean_data$BMI.Class)]rbPal <- colorRampPalette(c('yellow','blue'))final.cols <- rbPal(10)[as.numeric(cut(mean_data$BMI, breaks = 10))]#
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US Adults", main="Distance between Hmong, Karen and US Adult Females"    , col=final.cols, pch=final.pch, ylim=c(.22, .65))points(rep(-2,length(US_to_US)), US_to_US, col="gray")m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US Adults", main="Distance between Hmong, Karen and US Adult Females"    , col=final.cols, pch=final.pch) # wuf ylim=c(.22, .65)points(rep(-2,length(US_to_US)), US_to_US, col="gray")m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US Adults", main="Distance between Hmong, Karen and US Adult Females"    , col=final.cols, pch=final.pch, ylim=c(.3, .75)points(rep(-2,length(US_to_US)), US_to_US, col="gray")m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US Adults", main="Distance between Hmong, Karen and US Adult Females"    , col=final.cols, pch=final.pch, ylim=c(.3, .75))points(rep(-2,length(US_to_US)), US_to_US, col="gray")m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US Adults", main="Distance between Hmong, Karen and US Adult Females"    , col=final.cols, pch=final.pch, ylim=c(.5, .75))points(rep(-2,length(US_to_US)), US_to_US, col="gray")m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)
summary(m)
dm <- bc_dmggmap <- read.table("/Users/pvangay/Dropbox/UMN/KnightsLab/IMP/Sequencing/sequences_090716/4. EMBALMER_output/Yatsunenko_global_gut_study_850_mapping_file.txt",    sep="\t", quote="", row=1, head=T, comment.char="")gg_females <- rownames(ggmap)[ggmap$SEX == "female" & as.numeric(as.character(ggmap$AGE)) > 16 & ggmap$AGE != "None"]map <- read.table("/Users/pvangay/Dropbox/UMN/KnightsLab/IMP/Sequencing/sequences_090716/4. EMBALMER_output/mapping_merged.txt",    sep="\t", quote="", row=1, head=T, comment.char="")map$Age <- as.numeric(as.character(map$Age))map$Years.in.US <- as.numeric(as.character(map$Years.in.US))# let's only work with samples that are in both the mapping AND the dm filesvalid_samples <- intersect(rownames(dm), rownames(map))map <- map[valid_samples,]dm <- dm[valid_samples, valid_samples]US_adults <- rownames(map)[map$Ethnicity=="GAZ:United States of America" & map$Age > 16 & !is.na(map$Age)]US_adults <- intersect(US_adults,gg_females)Malawi_adults <- rownames(map)[map$Ethnicity=="GAZ:Malawi" & map$Age > 16 & !is.na(map$Age)]Venezuelan_adults <- rownames(map)[map$Ethnicity=="GAZ:Venezuela" & map$Age > 16 & !is.na(map$Age)]imp_samples <- rownames(map)[map$Ethnicity %in% c("Hmong", "Karen")] # plot each Hmong and/or Karen sample against average of US_adults# for each Hmong, calc the average of it's distance to all americansIMP_to_US <- NULLfor (i in 1:length(imp_samples)){    IMP_to_US[i] <- mean(as.numeric(dm[imp_samples[i], US_adults]))}names(IMP_to_US) <- imp_samples#mean US adultsUS_to_US <- NULLfor (i in 1:length(US_adults)){    US_to_US[i] <- mean(as.numeric(dm[US_adults[i], US_adults[-i]]))}mean_data <- cbind(IMP_to_US, map[imp_samples, c("Years.in.US", "Ethnicity", "Age", "BMI","BMI.Class")])colnames(mean_data) <- c("Distance.to.US", "Years.in.US", "Ethnicity", "Age","BMI", "BMI.Class")# exclude older people?# let's reset Years in US for the US-born to -10 so we can see this mean_data$Years.in.US[mean_data$Years.in.US==0] <- -1lookup <- c(19,17) # point typenames(lookup) <- sort(unique(mean_data$Ethnicity)) # let's Hmong to solid filled circle, Karen to filled trianglefinal.pch <- lookup[as.character(mean_data$Ethnicity)] # cols <- c("yellow","blue","green")# names(cols) <- sort(unique(mean_data$BMI.Class))# final.cols <- cols[as.character(mean_data$BMI.Class)]rbPal <- colorRampPalette(c('yellow','blue'))final.cols <- rbPal(10)[as.numeric(cut(mean_data$BMI, breaks = 10))]#
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US Adults", main="Distance between Hmong, Karen and US Adult Females"    , col=final.cols, pch=final.pch, ylim=c(.5, .75))points(rep(-2,length(US_to_US)), US_to_US, col="gray")m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US Adults", main="Distance between Hmong, Karen and US Adult Females"    , col=final.cols, pch=final.pch)points(rep(-2,length(US_to_US)), US_to_US, col="gray")m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)
max(mean_data)
mean_data <- cbind(IMP_to_US, map[imp_samples, c("Years.in.US", "Ethnicity", "Age", "BMI","BMI.Class")])colnames(mean_data) <- c("Distance.to.US", "Years.in.US", "Ethnicity", "Age","BMI", "BMI.Class")# exclude older people?# let's reset Years in US for the US-born to -10 so we can see this mean_data$Years.in.US[mean_data$Years.in.US==0] <- -1lookup <- c(19,17) # point typenames(lookup) <- sort(unique(mean_data$Ethnicity)) # let's Hmong to solid filled circle, Karen to filled trianglefinal.pch <- lookup[as.character(mean_data$Ethnicity)] # cols <- c("yellow","blue","green")# names(cols) <- sort(unique(mean_data$BMI.Class))# final.cols <- cols[as.character(mean_data$BMI.Class)]rbPal <- colorRampPalette(c('yellow','blue'))final.cols <- rbPal(10)[as.numeric(cut(mean_data$BMI, breaks = 10))]
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US Adults", main="Distance between Hmong, Karen and US Adult Females"    , col=final.cols, pch=final.pch)points(rep(-2,length(US_to_US)), US_to_US, col="gray")m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)
mean_data
max(mean_data$Distance.to.US)
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US Adults", main="Distance between Hmong, Karen and US Adult Females"    , col=final.cols, pch=final.pch, ylim=c(.5,1))points(rep(-2,length(US_to_US)), US_to_US, col="gray")
dm <- uwuf_dmggmap <- read.table("/Users/pvangay/Dropbox/UMN/KnightsLab/IMP/Sequencing/sequences_090716/4. EMBALMER_output/Yatsunenko_global_gut_study_850_mapping_file.txt",    sep="\t", quote="", row=1, head=T, comment.char="")gg_females <- rownames(ggmap)[ggmap$SEX == "female" & as.numeric(as.character(ggmap$AGE)) > 16 & ggmap$AGE != "None"]map <- read.table("/Users/pvangay/Dropbox/UMN/KnightsLab/IMP/Sequencing/sequences_090716/4. EMBALMER_output/mapping_merged.txt",    sep="\t", quote="", row=1, head=T, comment.char="")map$Age <- as.numeric(as.character(map$Age))map$Years.in.US <- as.numeric(as.character(map$Years.in.US))# let's only work with samples that are in both the mapping AND the dm filesvalid_samples <- intersect(rownames(dm), rownames(map))map <- map[valid_samples,]dm <- dm[valid_samples, valid_samples]US_adults <- rownames(map)[map$Ethnicity=="GAZ:United States of America" & map$Age > 16 & !is.na(map$Age)]US_adults <- intersect(US_adults,gg_females)Malawi_adults <- rownames(map)[map$Ethnicity=="GAZ:Malawi" & map$Age > 16 & !is.na(map$Age)]Venezuelan_adults <- rownames(map)[map$Ethnicity=="GAZ:Venezuela" & map$Age > 16 & !is.na(map$Age)]imp_samples <- rownames(map)[map$Ethnicity %in% c("Hmong", "Karen")] # plot each Hmong and/or Karen sample against average of US_adults# for each Hmong, calc the average of it's distance to all americansIMP_to_US <- NULLfor (i in 1:length(imp_samples)){    IMP_to_US[i] <- mean(as.numeric(dm[imp_samples[i], US_adults]))}names(IMP_to_US) <- imp_samples#mean US adultsUS_to_US <- NULLfor (i in 1:length(US_adults)){    US_to_US[i] <- mean(as.numeric(dm[US_adults[i], US_adults[-i]]))}mean_data <- cbind(IMP_to_US, map[imp_samples, c("Years.in.US", "Ethnicity", "Age", "BMI","BMI.Class")])colnames(mean_data) <- c("Distance.to.US", "Years.in.US", "Ethnicity", "Age","BMI", "BMI.Class")# exclude older people?# let's reset Years in US for the US-born to -10 so we can see this mean_data$Years.in.US[mean_data$Years.in.US==0] <- -1lookup <- c(19,17) # point typenames(lookup) <- sort(unique(mean_data$Ethnicity)) # let's Hmong to solid filled circle, Karen to filled trianglefinal.pch <- lookup[as.character(mean_data$Ethnicity)] # cols <- c("yellow","blue","green")# names(cols) <- sort(unique(mean_data$BMI.Class))# final.cols <- cols[as.character(mean_data$BMI.Class)]rbPal <- colorRampPalette(c('yellow','blue'))final.cols <- rbPal(10)[as.numeric(cut(mean_data$BMI, breaks = 10))]#
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US Adults", main="Distance between Hmong, Karen and US Adult Females"    , col=final.cols, pch=final.pch)points(rep(-2,length(US_to_US)), US_to_US, col="gray")m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US Adults", main="Distance between Hmong, Karen and US Adult Females"    , col=final.cols, pch=final.pch, ylim=c(.5, .75))points(rep(-2,length(US_to_US)), US_to_US, col="gray")
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US Adults", main="Distance between Hmong, Karen and US Adult Females"    , col=final.cols, pch=final.pch, ylim=c(.53, .75))points(rep(-2,length(US_to_US)), US_to_US, col="gray")
m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)
?legend
legend(pch=c(19,17), x="topright", cex=.6, legend=c("Hmong", "Karen"))
legend_image <- as.raster(rbPal(10)[10:1])text(x=0, y = seq(min(mean_data$Age),max(mean_data$Age),l=5), labels = seq(0,1,l=5))rasterImage(legend_image, 0, .5, .2, .7)
text(x=10, y = seq(min(data$Age),max(data$Age),l=5), labels = seq(0,1,l=5))
text(x=10, y = seq(min(mean_data$Age),max(mean_data$Age),l=5), labels = seq(0,1,l=5))
seq(min(mean_data$Age),max(mean_data$Age),l=5
)
rasterImage(legend_image, 10, .5, .2, .7)
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US Adults (Unweighted Unifrac)", main="Hmong and Karen vs. US Adult Females"    , col=final.cols, pch=final.pch, ylim=c(.53, .75))points(rep(-2,length(US_to_US)), US_to_US, col="gray")m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)legend(pch=c(19,17), x="topright", cex=.6, legend=c("Hmong", "Karen"))# add gradient image for age colorslegend_image <- as.raster(rbPal(10)[10:1])text(x=10, y = seq(min(mean_data$Age),max(mean_data$Age),l=5), labels = seq(0,1,l=5))rasterImage(legend_image, 10, .5, .2, .7)
rasterImage(legend_image, 0, .5, 9, .7)
?rasterImage
rasterImage(legend_image, 0, .5, .2, .7, angle=180)
legend(pch=c(19,17), x="topright", cex=.6, legend=c("Hmong", "Karen"))# add gradient image for age colorslegend_image <- as.raster(rbPal(10)[10:1])text(x=10, y = seq(min(mean_data$Age),max(mean_data$Age),l=5), labels = seq(0,1,l=5))rasterImage(legend_image, 0, .5, .2, .7, angle=90)
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US Adults (Unweighted Unifrac)", main="Hmong and Karen vs. US Adult Females"    , col=final.cols, pch=final.pch, ylim=c(.53, .75))points(rep(-2,length(US_to_US)), US_to_US, col="gray")m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)legend(pch=c(19,17), x="topright", cex=.6, legend=c("Hmong", "Karen"))# add gradient image for age colorslegend_image <- as.raster(rbPal(10)[10:1])text(x=10, y = seq(min(mean_data$Age),max(mean_data$Age),l=5), labels = seq(0,1,l=5))rasterImage(legend_image, 0, .5, .2, .7, angle=90)
rasterImage(legend_image, 0, .5, .2, .7, angle=25)
rasterImage(legend_image, 0, .5, .2, .7, angle=330)
rasterImage(legend_image, 0, .5, .2, .7, angle=360)
rasterImage(legend_image, 0, .5, .2, .7, angle=260)
rasterImage(legend_image, 0, .5, .2, .9, angle=260)
rasterImage(legend_image, 0, 1, .2, 2, angle=260)
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US Adults (Unweighted Unifrac)", main="Hmong and Karen vs. US Adult Females"    , col=final.cols, pch=final.pch, ylim=c(.53, .75))points(rep(-2,length(US_to_US)), US_to_US, col="gray")m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)legend(pch=c(19,17), x="topright", cex=.6, legend=c("Hmong", "Karen"))# add gradient image for age colorslegend_image <- as.raster(rbPal(10)[10:1])text(x=10, y = seq(min(mean_data$Age),max(mean_data$Age),l=5), labels = seq(0,1,l=5))rasterImage(legend_image, 0, 1, .2, 2, angle=260)
rasterImage(legend_image, 0, .5, .2, .55, angle=260)
rasterImage(legend_image, 0, .5, .2, .55)
rasterImage(legend_image, 0, .5, .4, .55)
rasterImage(legend_image, 0, .5, .6, .55)
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US Adults (Unweighted Unifrac)", main="Hmong and Karen vs. US Adult Females"    , col=final.cols, pch=final.pch, ylim=c(.53, .75))points(rep(-2,length(US_to_US)), US_to_US, col="gray")m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)legend(pch=c(19,17), x="topright", cex=.6, legend=c("Hmong", "Karen"))# add gradient image for age colorslegend_image <- as.raster(rbPal(10)[10:1])text(x=10, y = seq(min(mean_data$Age),max(mean_data$Age),l=5), labels = seq(0,1,l=5))rasterImage(legend_image, 0, .5, .7, .6)
rasterImage(legend_image, 0, .5, .7, .6, angle=260)
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US Adults (Unweighted Unifrac)", main="Hmong and Karen vs. US Adult Females"    , col=final.cols, pch=final.pch, ylim=c(.53, .75))points(rep(-2,length(US_to_US)), US_to_US, col="gray")m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)legend(pch=c(19,17), x="topright", cex=.6, legend=c("Hmong", "Karen"))# add gradient image for age colorslegend_image <- as.raster(rbPal(10)[10:1])text(x=10, y = seq(min(mean_data$Age),max(mean_data$Age),l=5), labels = seq(0,1,l=5))rasterImage(legend_image, 0, .5, .7, .6, angle=260)
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US Adults (Unweighted Unifrac)", main="Hmong and Karen vs. US Adult Females"    , col=final.cols, pch=final.pch, ylim=c(.53, .75))points(rep(-2,length(US_to_US)), US_to_US, col="gray")m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)legend(pch=c(19,17), x="topright", cex=.6, legend=c("Hmong", "Karen"))# add gradient image for age colorslegend_image <- as.raster(rbPal(10)[10:1])text(x=10, y = seq(min(mean_data$Age),max(mean_data$Age),l=5), labels = seq(0,1,l=5))rasterImage(legend_image, 0, .5, .7, .6, angle=90)
rasterImage(legend_image, 0, .5, .7, .6, angle=270)
rasterImage(legend_image, 0, .6, .7, .7, angle=270)
rasterImage(legend_image, 0, .55, .7, .6, angle=270)
rasterImage(legend_image, 30, .55, 30.7, .6, angle=270)
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US Adults (Unweighted Unifrac)", main="Hmong and Karen vs. US Adult Females"    , col=final.cols, pch=final.pch, ylim=c(.53, .75))points(rep(-2,length(US_to_US)), US_to_US, col="gray")m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)legend(pch=c(19,17), x="topright", cex=.6, legend=c("Hmong", "Karen"))# add gradient image for age colorslegend_image <- as.raster(rbPal(10)[10:1])text(x=10, y = seq(min(mean_data$Age),max(mean_data$Age),l=5), labels = seq(0,1,l=5))rasterImage(legend_image, 30, .55, 30.7, .6, angle=270)
text(x=35, y = seq(min(mean_data$Age),max(mean_data$Age),l=5), labels = seq(0,1,l=5))
seq(min(mean_data$Age),max(mean_data$Age),l=5)
text(y=.56, x = seq(min(mean_data$Age),max(mean_data$Age),l=5), labels = seq(0,1,l=5))
?text
min(mean_data$Age)
max(mean_data$Age)
text(y=.56, x = c(30,40), labels = c(18,65))
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US Adults (Unweighted Unifrac)", main="Hmong and Karen vs. US Adult Females"    , col=final.cols, pch=final.pch, ylim=c(.53, .75))points(rep(-2,length(US_to_US)), US_to_US, col="gray")m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)legend(pch=c(19,17), x="topright", cex=.6, legend=c("Hmong", "Karen"))# add gradient image for age colorslegend_image <- as.raster(rbPal(10)[10:1])text(y=.56, x = c(30,40), labels = c(18,65))rasterImage(legend_image, 30, .55, 30.7, .6, angle=270)
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US Adults (Unweighted Unifrac)", main="Hmong and Karen vs. US Adult Females"    , col=final.cols, pch=final.pch, ylim=c(.53, .75))points(rep(-2,length(US_to_US)), US_to_US, col="gray")m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)legend(pch=c(19,17), x="topright", cex=.6, legend=c("Hmong", "Karen"))# add gradient image for age colorslegend_image <- as.raster(rbPal(10)[10:1])text(y=.55, x = c(30,40), labels = c(18,65))rasterImage(legend_image, 30, .55, 40, .6, angle=270)
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US Adults (Unweighted Unifrac)", main="Hmong and Karen vs. US Adult Females"    , col=final.cols, pch=final.pch, ylim=c(.53, .75))points(rep(-2,length(US_to_US)), US_to_US, col="gray")m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)legend(pch=c(19,17), x="topright", cex=.6, legend=c("Hmong", "Karen"))# add gradient image for age colorslegend_image <- as.raster(rbPal(10)[10:1])text(y=.55, x = c(30,40), labels = c(18,65))rasterImage(legend_image, 30, .55, 30.7, .6, angle=270)
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US Adults (Unweighted Unifrac)", main="Hmong and Karen vs. US Adult Females"    , col=final.cols, pch=final.pch, ylim=c(.53, .75))points(rep(-2,length(US_to_US)), US_to_US, col="gray")m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)legend(pch=c(19,17), x="topright", cex=.6, legend=c("Hmong", "Karen"))# add gradient image for age colorslegend_image <- as.raster(rbPal(10)[10:1])text(y=.555, x = c(30,40), labels = c(18,65))rasterImage(legend_image, 30, .55, 30.7, .6, angle=270)
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US Adults (Unweighted Unifrac)", main="Hmong and Karen vs. US Adult Females"    , col=final.cols, pch=final.pch, ylim=c(.53, .75))points(rep(-2,length(US_to_US)), US_to_US, col="gray")m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)legend(pch=c(19,17), x="topright", cex=.6, legend=c("Hmong", "Karen"))# add gradient image for age colorslegend_image <- as.raster(rbPal(10)[10:1])text(y=.555, x = c(30,40), labels = c(18,65))rasterImage(legend_image, 30, .55, 30.7, .65, angle=270)
rasterImage(legend_image, 30, .55, 30.7, .63, angle=270)
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US Adults (Unweighted Unifrac)", main="Hmong and Karen vs. US Adult Females"    , col=final.cols, pch=final.pch, ylim=c(.53, .75))points(rep(-2,length(US_to_US)), US_to_US, col="gray")m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)legend(pch=c(19,17), x="topright", cex=.6, legend=c("Hmong", "Karen"))# add gradient image for age colorslegend_image <- as.raster(rbPal(10)[10:1])text(y=.555, x = c(30,40), labels = c(18,65))rasterImage(legend_image, 30, .55, 30.7, .63, angle=270)
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US Adults (Unweighted Unifrac)", main="Hmong and Karen vs. US Adult Females"    , col=final.cols, pch=final.pch, ylim=c(.53, .75))points(rep(-2,length(US_to_US)), US_to_US, col="gray")m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)legend(pch=c(19,17), x="topright", cex=.6, legend=c("Hmong", "Karen"))# add gradient image for age colorslegend_image <- as.raster(rbPal(10)[10:1])text(y=.555, x = c(30,40), labels = c(18,65))rasterImage(legend_image, 30, .55, 30.7, .62, angle=270)
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US Adults (Unweighted Unifrac)", main="Hmong and Karen vs. US Adult Females"    , col=final.cols, pch=final.pch, ylim=c(.53, .75))points(rep(-2,length(US_to_US)), US_to_US, col="gray")m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)legend(pch=c(19,17), x="topright", cex=.6, legend=c("Hmong", "Karen"))# add gradient image for age colorslegend_image <- as.raster(rbPal(10)[10:1])text(y=.555, x = c(30,40), labels = c(18,65))rasterImage(legend_image, 30, .55, 30.7, .61, angle=270)
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US Adults (Unweighted Unifrac)", main="Hmong and Karen vs. US Adult Females"    , col=final.cols, pch=final.pch, ylim=c(.53, .75))points(rep(-2,length(US_to_US)), US_to_US, col="gray")m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)legend(pch=c(19,17), x="topright", cex=.6, legend=c("Hmong", "Karen"))# add gradient image for age colorslegend_image <- as.raster(rbPal(10)[10:1])text(y=.555, x = c(30,35,40), labels = c("18","AGE","65"))rasterImage(legend_image, 30, .55, 30.7, .61, angle=270)
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US Adults (Unweighted Unifrac)", main="Hmong and Karen vs. US Adult Females"    , col=final.cols, pch=final.pch, ylim=c(.53, .75))points(rep(-2,length(US_to_US)), US_to_US, col="gray")m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)legend(pch=c(19,17), x="topright", cex=.6, legend=c("Hmong", "Karen"))# add gradient image for age colorslegend_image <- as.raster(rbPal(10)[10:1])text(y=.555, x = c(30,35,40), labels = c("18","Age","65"))rasterImage(legend_image, 30, .55, 30.7, .61, angle=270)
rbPal <- colorRampPalette(c('yellow','blue'))final.cols <- rbPal(10)[as.numeric(cut(mean_data$Age, breaks = 10))]#
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US Adults (Unweighted Unifrac)", main="Hmong and Karen vs. US Adult Females"    , col=final.cols, pch=final.pch, ylim=c(.53, .75))points(rep(-2,length(US_to_US)), US_to_US, col="gray")m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)legend(pch=c(19,17), x="topright", cex=.6, legend=c("Hmong", "Karen"))# add gradient image for age colorslegend_image <- as.raster(rbPal(10)[10:1])text(y=.555, x = c(30,35,40), labels = c("18","Age","65"))rasterImage(legend_image, 30, .55, 30.7, .61, angle=270)
max(mean_data$BMI)
rbPal <- colorRampPalette(c('yellow','blue'))final.cols <- rbPal(10)[as.numeric(cut(mean_data$BMI, breaks = 10))]#
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US Adults (Unweighted Unifrac)", main="Hmong and Karen vs. US Adult Females"    , col=final.cols, pch=final.pch, ylim=c(.53, .75))points(rep(-2,length(US_to_US)), US_to_US, col="gray")m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)legend(pch=c(19,17), x="topright", cex=.6, legend=c("Hmong", "Karen"))# add gradient image for age colorslegend_image <- as.raster(rbPal(10)[10:1])text(y=.555, x = c(30,35,40), labels = c("17","BMI","43"))rasterImage(legend_image, 30, .55, 30.7, .61, angle=270)
imp_samples <- rownames(map)[map$Ethnicity %in% c("Karen")] # plot each Hmong and/or Karen sample against average of US_adults# for each Hmong, calc the average of it's distance to all americansIMP_to_US <- NULLfor (i in 1:length(imp_samples)){    IMP_to_US[i] <- mean(as.numeric(dm[imp_samples[i], US_adults]))}names(IMP_to_US) <- imp_samples#mean US adultsUS_to_US <- NULLfor (i in 1:length(US_adults)){    US_to_US[i] <- mean(as.numeric(dm[US_adults[i], US_adults[-i]]))}mean_data <- cbind(IMP_to_US, map[imp_samples, c("Years.in.US", "Ethnicity", "Age", "BMI","BMI.Class")])colnames(mean_data) <- c("Distance.to.US", "Years.in.US", "Ethnicity", "Age","BMI", "BMI.Class")# exclude older people?# let's reset Years in US for the US-born to -10 so we can see this mean_data$Years.in.US[mean_data$Years.in.US==0] <- -1lookup <- c(19,17) # point typenames(lookup) <- sort(unique(mean_data$Ethnicity)) # let's Hmong to solid filled circle, Karen to filled trianglefinal.pch <- lookup[as.character(mean_data$Ethnicity)] # cols <- c("yellow","blue","green")# names(cols) <- sort(unique(mean_data$BMI.Class))# final.cols <- cols[as.character(mean_data$BMI.Class)]rbPal <- colorRampPalette(c('yellow','blue'))final.cols <- rbPal(10)[as.numeric(cut(mean_data$BMI, breaks = 10))]#
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US Adults (Unweighted Unifrac)", main="Hmong and Karen vs. US Adult Females"    , col=final.cols, pch=final.pch, ylim=c(.53, .75))points(rep(-2,length(US_to_US)), US_to_US, col="gray")m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)
summary(m)
imp_samples <- rownames(map)[map$Ethnicity %in% c("Hmong")] # plot each Hmong and/or Karen sample against average of US_adults# for each Hmong, calc the average of it's distance to all americansIMP_to_US <- NULLfor (i in 1:length(imp_samples)){    IMP_to_US[i] <- mean(as.numeric(dm[imp_samples[i], US_adults]))}names(IMP_to_US) <- imp_samples#mean US adultsUS_to_US <- NULLfor (i in 1:length(US_adults)){    US_to_US[i] <- mean(as.numeric(dm[US_adults[i], US_adults[-i]]))}mean_data <- cbind(IMP_to_US, map[imp_samples, c("Years.in.US", "Ethnicity", "Age", "BMI","BMI.Class")])colnames(mean_data) <- c("Distance.to.US", "Years.in.US", "Ethnicity", "Age","BMI", "BMI.Class")# exclude older people?# let's reset Years in US for the US-born to -10 so we can see this mean_data$Years.in.US[mean_data$Years.in.US==0] <- -1lookup <- c(19,17) # point typenames(lookup) <- sort(unique(mean_data$Ethnicity)) # let's Hmong to solid filled circle, Karen to filled trianglefinal.pch <- lookup[as.character(mean_data$Ethnicity)] # cols <- c("yellow","blue","green")# names(cols) <- sort(unique(mean_data$BMI.Class))# final.cols <- cols[as.character(mean_data$BMI.Class)]rbPal <- colorRampPalette(c('yellow','blue'))final.cols <- rbPal(10)[as.numeric(cut(mean_data$BMI, breaks = 10))]#
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US Adults (Unweighted Unifrac)", main="Hmong and Karen vs. US Adult Females"    , col=final.cols, pch=final.pch, ylim=c(.53, .75))points(rep(-2,length(US_to_US)), US_to_US, col="gray")m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)
imp_samples <- rownames(map)[map$Ethnicity %in% c("Karen")] # plot each Hmong and/or Karen sample against average of US_adults# for each Hmong, calc the average of it's distance to all americansIMP_to_US <- NULLfor (i in 1:length(imp_samples)){    IMP_to_US[i] <- mean(as.numeric(dm[imp_samples[i], US_adults]))}names(IMP_to_US) <- imp_samples#mean US adultsUS_to_US <- NULLfor (i in 1:length(US_adults)){    US_to_US[i] <- mean(as.numeric(dm[US_adults[i], US_adults[-i]]))}mean_data <- cbind(IMP_to_US, map[imp_samples, c("Years.in.US", "Ethnicity", "Age", "BMI","BMI.Class")])colnames(mean_data) <- c("Distance.to.US", "Years.in.US", "Ethnicity", "Age","BMI", "BMI.Class")# exclude older people?# let's reset Years in US for the US-born to -10 so we can see this mean_data$Years.in.US[mean_data$Years.in.US==0] <- -1lookup <- c(19,17) # point typenames(lookup) <- sort(unique(mean_data$Ethnicity)) # let's Hmong to solid filled circle, Karen to filled trianglefinal.pch <- lookup[as.character(mean_data$Ethnicity)] # cols <- c("yellow","blue","green")# names(cols) <- sort(unique(mean_data$BMI.Class))# final.cols <- cols[as.character(mean_data$BMI.Class)]rbPal <- colorRampPalette(c('yellow','blue'))final.cols <- rbPal(10)[as.numeric(cut(mean_data$BMI, breaks = 10))]#
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US Adults (Unweighted Unifrac)", main="Hmong and Karen vs. US Adult Females"    , col=final.cols, pch=final.pch, ylim=c(.53, .75))points(rep(-2,length(US_to_US)), US_to_US, col="gray")m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)
US_to_US
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US Adults (Unweighted Unifrac)", main="Hmong and Karen vs. US Adult Females"    , col=final.cols, pch=final.pch, ylim=c(.53, .75))points(rep(0,length(US_to_US)), US_to_US, col="gray")m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)
max(mean_data$BMI)
min(mean_data$BMI)
#legend(pch=c(19,17), x="topright", cex=.6, legend=c("Hmong", "Karen"))# add gradient image for age colorslegend_image <- as.raster(rbPal(10)[10:1])text(y=.555, x = c(30,35,40), labels = c("17","BMI","39"))rasterImage(legend_image, 30, .55, 30.7, .61, angle=270)
legend_image <- as.raster(rbPal(10)[10:1])text(y=.555, x = c(30,35,40), labels = c("17","BMI","39"))rasterImage(legend_image, 30, .55, 30.7, .61, angle=270)
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US Adults (Unweighted Unifrac)", main="Karen vs. US Adult Females"    , col=final.cols, pch=final.pch, ylim=c(.53, .75))points(rep(0,length(US_to_US)), US_to_US, col="gray")m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)
imp_samples <- rownames(map)[map$Ethnicity %in% c("Hmong")] # plot each Hmong and/or Karen sample against average of US_adults# for each Hmong, calc the average of it's distance to all americansIMP_to_US <- NULLfor (i in 1:length(imp_samples)){    IMP_to_US[i] <- mean(as.numeric(dm[imp_samples[i], US_adults]))}names(IMP_to_US) <- imp_samples#mean US adultsUS_to_US <- NULLfor (i in 1:length(US_adults)){    US_to_US[i] <- mean(as.numeric(dm[US_adults[i], US_adults[-i]]))}mean_data <- cbind(IMP_to_US, map[imp_samples, c("Years.in.US", "Ethnicity", "Age", "BMI","BMI.Class")])colnames(mean_data) <- c("Distance.to.US", "Years.in.US", "Ethnicity", "Age","BMI", "BMI.Class")# exclude older people?# let's reset Years in US for the US-born to -10 so we can see this mean_data$Years.in.US[mean_data$Years.in.US==0] <- -1lookup <- c(19,17) # point typenames(lookup) <- sort(unique(mean_data$Ethnicity)) # let's Hmong to solid filled circle, Karen to filled trianglefinal.pch <- lookup[as.character(mean_data$Ethnicity)] # cols <- c("yellow","blue","green")# names(cols) <- sort(unique(mean_data$BMI.Class))# final.cols <- cols[as.character(mean_data$BMI.Class)]rbPal <- colorRampPalette(c('yellow','blue'))final.cols <- rbPal(10)[as.numeric(cut(mean_data$BMI, breaks = 10))]#
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US Adults (Unweighted Unifrac)", main="Hmong vs. US Adult Females"    , col=final.cols, pch=final.pch, ylim=c(.53, .75))points(rep(0,length(US_to_US)), US_to_US, col="gray")m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)
imp_samples <- rownames(map)[map$Ethnicity %in% c("Hmong", "Karen") & map$Years.in.US != 0] US_born_samples <- rownames(map)[map$Ethnicity %in% c("Hmong") & map$Years.in.US == 0] # plot each Hmong and/or Karen sample against average of US_adults# for each Hmong, calc the average of it's distance to all americansIMP_to_US <- NULLfor (i in 1:length(imp_samples)){    IMP_to_US[i] <- mean(as.numeric(dm[imp_samples[i], US_born_samples]))}names(IMP_to_US) <- imp_samples
mean_data <- cbind(IMP_to_US, map[imp_samples, c("Years.in.US", "Ethnicity", "Age", "BMI","BMI.Class")])colnames(mean_data) <- c("Distance.to.US", "Years.in.US", "Ethnicity", "Age","BMI", "BMI.Class")# exclude older people?# let's reset Years in US for the US-born to -10 so we can see this mean_data$Years.in.US[mean_data$Years.in.US==0] <- -1lookup <- c(19,17) # point typenames(lookup) <- sort(unique(mean_data$Ethnicity)) # let's Hmong to solid filled circle, Karen to filled trianglefinal.pch <- lookup[as.character(mean_data$Ethnicity)] # cols <- c("yellow","blue","green")# names(cols) <- sort(unique(mean_data$BMI.Class))# final.cols <- cols[as.character(mean_data$BMI.Class)]rbPal <- colorRampPalette(c('yellow','blue'))final.cols <- rbPal(10)[as.numeric(cut(mean_data$BMI, breaks = 10))]#
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US Adults (Unweighted Unifrac)", main="Hmong vs. US Adult Females"    , col=final.cols, pch=final.pch, ylim=c(.53, .75))points(rep(0,length(US_to_US)), US_to_US, col="gray")m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US Adults (Unweighted Unifrac)", main="Hmong vs. US Adult Females"    , col=final.cols, pch=final.pch)
imp_samples <- rownames(map)[map$Ethnicity %in% c("Hmong") & map$Years.in.US != 0] US_born_samples <- rownames(map)[map$Ethnicity %in% c("Hmong") & map$Years.in.US == 0] # plot each Hmong and/or Karen sample against average of US_adults# for each Hmong, calc the average of it's distance to all americansIMP_to_US <- NULLfor (i in 1:length(imp_samples)){    IMP_to_US[i] <- mean(as.numeric(dm[imp_samples[i], US_born_samples]))}names(IMP_to_US) <- imp_samples#mean US adultsUS_to_US <- NULLfor (i in 1:length(US_adults)){    US_to_US[i] <- mean(as.numeric(dm[US_adults[i], US_adults[-i]]))}mean_data <- cbind(IMP_to_US, map[imp_samples, c("Years.in.US", "Ethnicity", "Age", "BMI","BMI.Class")])colnames(mean_data) <- c("Distance.to.US", "Years.in.US", "Ethnicity", "Age","BMI", "BMI.Class")# exclude older people?# let's reset Years in US for the US-born to -10 so we can see this mean_data$Years.in.US[mean_data$Years.in.US==0] <- -1lookup <- c(19,17) # point typenames(lookup) <- sort(unique(mean_data$Ethnicity)) # let's Hmong to solid filled circle, Karen to filled trianglefinal.pch <- lookup[as.character(mean_data$Ethnicity)] # cols <- c("yellow","blue","green")# names(cols) <- sort(unique(mean_data$BMI.Class))# final.cols <- cols[as.character(mean_data$BMI.Class)]rbPal <- colorRampPalette(c('yellow','blue'))final.cols <- rbPal(10)[as.numeric(cut(mean_data$BMI, breaks = 10))]#
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US Adults (Unweighted Unifrac)", main="Hmong vs. US Adult Females"    , col=final.cols, pch=final.pch)#points(rep(0,length(US_to_US)), US_to_US, col="gray")m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)
imp_samples <- rownames(map)[map$Ethnicity %in% c("Hmong", "Karen") & map$Years.in.US != 0] US_born_samples <- rownames(map)[map$Ethnicity %in% c("Hmong") & map$Years.in.US == 0] # plot each Hmong and/or Karen sample against average of US_adults# for each Hmong, calc the average of it's distance to all americansIMP_to_US <- NULLfor (i in 1:length(imp_samples)){    IMP_to_US[i] <- mean(as.numeric(dm[imp_samples[i], US_born_samples]))}names(IMP_to_US) <- imp_samples#mean US adultsUS_to_US <- NULLfor (i in 1:length(US_adults)){    US_to_US[i] <- mean(as.numeric(dm[US_adults[i], US_adults[-i]]))}mean_data <- cbind(IMP_to_US, map[imp_samples, c("Years.in.US", "Ethnicity", "Age", "BMI","BMI.Class")])colnames(mean_data) <- c("Distance.to.US", "Years.in.US", "Ethnicity", "Age","BMI", "BMI.Class")# exclude older people?# let's reset Years in US for the US-born to -10 so we can see this mean_data$Years.in.US[mean_data$Years.in.US==0] <- -1lookup <- c(19,17) # point typenames(lookup) <- sort(unique(mean_data$Ethnicity)) # let's Hmong to solid filled circle, Karen to filled trianglefinal.pch <- lookup[as.character(mean_data$Ethnicity)] # cols <- c("yellow","blue","green")# names(cols) <- sort(unique(mean_data$BMI.Class))# final.cols <- cols[as.character(mean_data$BMI.Class)]rbPal <- colorRampPalette(c('yellow','blue'))final.cols <- rbPal(10)[as.numeric(cut(mean_data$BMI, breaks = 10))]#
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US Adults (Unweighted Unifrac)", main="Hmong vs. US Adult Females"    , col=final.cols, pch=final.pch)#points(rep(0,length(US_to_US)), US_to_US, col="gray")m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)
imp_samples <- rownames(map)[map$Ethnicity %in% c("Hmong", "Karen") & map$Years.in.US < 20] US_born_samples <- rownames(map)[map$Ethnicity %in% c("Hmong") & map$Years.in.US == 0] # plot each Hmong and/or Karen sample against average of US_adults# for each Hmong, calc the average of it's distance to all americansIMP_to_US <- NULLfor (i in 1:length(imp_samples)){    IMP_to_US[i] <- mean(as.numeric(dm[imp_samples[i], US_born_samples]))}names(IMP_to_US) <- imp_samples#mean US adultsUS_to_US <- NULLfor (i in 1:length(US_adults)){    US_to_US[i] <- mean(as.numeric(dm[US_adults[i], US_adults[-i]]))}mean_data <- cbind(IMP_to_US, map[imp_samples, c("Years.in.US", "Ethnicity", "Age", "BMI","BMI.Class")])colnames(mean_data) <- c("Distance.to.US", "Years.in.US", "Ethnicity", "Age","BMI", "BMI.Class")# exclude older people?# let's reset Years in US for the US-born to -10 so we can see this mean_data$Years.in.US[mean_data$Years.in.US==0] <- -1lookup <- c(19,17) # point typenames(lookup) <- sort(unique(mean_data$Ethnicity)) # let's Hmong to solid filled circle, Karen to filled trianglefinal.pch <- lookup[as.character(mean_data$Ethnicity)] # cols <- c("yellow","blue","green")# names(cols) <- sort(unique(mean_data$BMI.Class))# final.cols <- cols[as.character(mean_data$BMI.Class)]rbPal <- colorRampPalette(c('yellow','blue'))final.cols <- rbPal(10)[as.numeric(cut(mean_data$BMI, breaks = 10))]#
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US Adults (Unweighted Unifrac)", main="Hmong vs. US Adult Females"    , col=final.cols, pch=final.pch)#points(rep(0,length(US_to_US)), US_to_US, col="gray")m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)
imp_samples <- rownames(map)[map$Ethnicity %in% c("Hmong", "Karen") & map$Years.in.US != 0 & map$Years.in.US < 20] US_born_samples <- rownames(map)[map$Ethnicity %in% c("Hmong") & map$Years.in.US == 0] # plot each Hmong and/or Karen sample against average of US_adults# for each Hmong, calc the average of it's distance to all americansIMP_to_US <- NULLfor (i in 1:length(imp_samples)){    IMP_to_US[i] <- mean(as.numeric(dm[imp_samples[i], US_born_samples]))}names(IMP_to_US) <- imp_samples#mean US adultsUS_to_US <- NULLfor (i in 1:length(US_adults)){    US_to_US[i] <- mean(as.numeric(dm[US_adults[i], US_adults[-i]]))}mean_data <- cbind(IMP_to_US, map[imp_samples, c("Years.in.US", "Ethnicity", "Age", "BMI","BMI.Class")])colnames(mean_data) <- c("Distance.to.US", "Years.in.US", "Ethnicity", "Age","BMI", "BMI.Class")# exclude older people?# let's reset Years in US for the US-born to -10 so we can see this mean_data$Years.in.US[mean_data$Years.in.US==0] <- -1lookup <- c(19,17) # point typenames(lookup) <- sort(unique(mean_data$Ethnicity)) # let's Hmong to solid filled circle, Karen to filled trianglefinal.pch <- lookup[as.character(mean_data$Ethnicity)] # cols <- c("yellow","blue","green")# names(cols) <- sort(unique(mean_data$BMI.Class))# final.cols <- cols[as.character(mean_data$BMI.Class)]rbPal <- colorRampPalette(c('yellow','blue'))final.cols <- rbPal(10)[as.numeric(cut(mean_data$BMI, breaks = 10))]#
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US Adults (Unweighted Unifrac)", main="Hmong vs. US Adult Females"    , col=final.cols, pch=final.pch)#points(rep(0,length(US_to_US)), US_to_US, col="gray")m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)
imp_samples <- rownames(map)[map$Ethnicity %in% c("Hmong") & map$Years.in.US != 0 & map$Years.in.US < 20] US_born_samples <- rownames(map)[map$Ethnicity %in% c("Hmong") & map$Years.in.US == 0] # plot each Hmong and/or Karen sample against average of US_adults# for each Hmong, calc the average of it's distance to all americansIMP_to_US <- NULLfor (i in 1:length(imp_samples)){    IMP_to_US[i] <- mean(as.numeric(dm[imp_samples[i], US_born_samples]))}names(IMP_to_US) <- imp_samples#mean US adultsUS_to_US <- NULLfor (i in 1:length(US_adults)){    US_to_US[i] <- mean(as.numeric(dm[US_adults[i], US_adults[-i]]))}mean_data <- cbind(IMP_to_US, map[imp_samples, c("Years.in.US", "Ethnicity", "Age", "BMI","BMI.Class")])colnames(mean_data) <- c("Distance.to.US", "Years.in.US", "Ethnicity", "Age","BMI", "BMI.Class")# exclude older people?# let's reset Years in US for the US-born to -10 so we can see this mean_data$Years.in.US[mean_data$Years.in.US==0] <- -1lookup <- c(19,17) # point typenames(lookup) <- sort(unique(mean_data$Ethnicity)) # let's Hmong to solid filled circle, Karen to filled trianglefinal.pch <- lookup[as.character(mean_data$Ethnicity)] # cols <- c("yellow","blue","green")# names(cols) <- sort(unique(mean_data$BMI.Class))# final.cols <- cols[as.character(mean_data$BMI.Class)]rbPal <- colorRampPalette(c('yellow','blue'))final.cols <- rbPal(10)[as.numeric(cut(mean_data$BMI, breaks = 10))]#
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US Adults (Unweighted Unifrac)", main="Hmong vs. US Adult Females"    , col=final.cols, pch=final.pch)#points(rep(0,length(US_to_US)), US_to_US, col="gray")m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)
imp_samples <- rownames(map)[map$Ethnicity %in% c("Hmong", "Karen") & map$Years.in.US != 0 & map$Years.in.US < 20] US_born_samples <- rownames(map)[map$Ethnicity %in% c("Hmong") & map$Years.in.US == 0] # plot each Hmong and/or Karen sample against average of US_adults# for each Hmong, calc the average of it's distance to all americansIMP_to_US <- NULLfor (i in 1:length(imp_samples)){    IMP_to_US[i] <- mean(as.numeric(dm[imp_samples[i], US_born_samples]))}names(IMP_to_US) <- imp_samples#mean US adultsUS_to_US <- NULLfor (i in 1:length(US_adults)){    US_to_US[i] <- mean(as.numeric(dm[US_adults[i], US_adults[-i]]))}mean_data <- cbind(IMP_to_US, map[imp_samples, c("Years.in.US", "Ethnicity", "Age", "BMI","BMI.Class")])colnames(mean_data) <- c("Distance.to.US", "Years.in.US", "Ethnicity", "Age","BMI", "BMI.Class")# exclude older people?# let's reset Years in US for the US-born to -10 so we can see this mean_data$Years.in.US[mean_data$Years.in.US==0] <- -1lookup <- c(19,17) # point typenames(lookup) <- sort(unique(mean_data$Ethnicity)) # let's Hmong to solid filled circle, Karen to filled trianglefinal.pch <- lookup[as.character(mean_data$Ethnicity)] # cols <- c("yellow","blue","green")# names(cols) <- sort(unique(mean_data$BMI.Class))# final.cols <- cols[as.character(mean_data$BMI.Class)]rbPal <- colorRampPalette(c('yellow','blue'))final.cols <- rbPal(10)[as.numeric(cut(mean_data$BMI, breaks = 10))]#
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US Adults (Unweighted Unifrac)", main="Hmong vs. US Adult Females"    , col=final.cols, pch=final.pch)#points(rep(0,length(US_to_US)), US_to_US, col="gray")m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)
imp_samples <- rownames(map)[map$Ethnicity %in% c("Hmong", "Karen") & map$Years.in.US != 0 & map$Years.in.US < 20] US_born_samples <- rownames(map)[map$Ethnicity %in% c("Hmong") & map$Years.in.US == 0] # plot each Hmong and/or Karen sample against average of US_adults# for each Hmong, calc the average of it's distance to all americansIMP_to_US <- NULLfor (i in 1:length(imp_samples)){    IMP_to_US[i] <- mean(as.numeric(dm[imp_samples[i], US_born_samples]))}names(IMP_to_US) <- imp_samples#mean US adultsUS_to_US <- NULLfor (i in 1:length(US_adults)){    US_to_US[i] <- mean(as.numeric(dm[US_adults[i], US_adults[-i]]))}mean_data <- cbind(IMP_to_US, map[imp_samples, c("Years.in.US", "Ethnicity", "Age", "BMI","BMI.Class")])colnames(mean_data) <- c("Distance.to.US", "Years.in.US", "Ethnicity", "Age","BMI", "BMI.Class")# exclude older people?# let's reset Years in US for the US-born to -10 so we can see this mean_data$Years.in.US[mean_data$Years.in.US==0] <- -1lookup <- c(19,17) # point typenames(lookup) <- sort(unique(mean_data$Ethnicity)) # let's Hmong to solid filled circle, Karen to filled trianglefinal.pch <- lookup[as.character(mean_data$Ethnicity)] # cols <- c("yellow","blue","green")# names(cols) <- sort(unique(mean_data$BMI.Class))# final.cols <- cols[as.character(mean_data$BMI.Class)]rbPal <- colorRampPalette(c('yellow','blue'))final.cols <- rbPal(10)[as.numeric(cut(mean_data$BMI, breaks = 10))]#
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US Adults (Unweighted Unifrac)", main="Hmong, Karen vs. US Adult Females"    , col=final.cols, pch=final.pch)#points(rep(0,length(US_to_US)), US_to_US, col="gray")m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)legend(pch=c(19,17), x="topright", cex=.6, legend=c("Hmong", "Karen"))
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US Adults (Unweighted Unifrac)", main="Hmong, Karen vs. US-born Hmong"    , col=final.cols, pch=final.pch)#points(rep(0,length(US_to_US)), US_to_US, col="gray")m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)legend(pch=c(19,17), x="topright", cex=.6, legend=c("Hmong", "Karen"))
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US-born Hmong (Unweighted Unifrac)", main="Hmong, Karen vs. US-born Hmong"    , col=final.cols, pch=final.pch)#points(rep(0,length(US_to_US)), US_to_US, col="gray")m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)legend(pch=c(19,17), x="topright", cex=.6, legend=c("Hmong", "Karen"))
summary(m)
setwd("/Users/pvangay/Dropbox/UMN/KnightsLab/IMP/Sequencing/sequences_090716/analysis")# load distance matriceswuf_dm <- read.table("/Users/pvangay/Dropbox/UMN/KnightsLab/IMP/Sequencing/sequences_090716/beta_div/beta_ggadults/weighted_unifrac_dm.txt", sep="\t", quote="", row=1, head=T)uwuf_dm <- read.table("/Users/pvangay/Dropbox/UMN/KnightsLab/IMP/Sequencing/sequences_090716/beta_div/beta_ggadults/unweighted_unifrac_dm.txt", sep="\t", quote="", row=1, head=T)bc_dm <- read.table("/Users/pvangay/Dropbox/UMN/KnightsLab/IMP/Sequencing/sequences_090716/beta_div/beta_ggadults/bray_curtis_dm.txt", sep="\t", quote="", row=1, head=T)# let's try wuf firstdm <- uwuf_dmggmap <- read.table("/Users/pvangay/Dropbox/UMN/KnightsLab/IMP/Sequencing/sequences_090716/4. EMBALMER_output/Yatsunenko_global_gut_study_850_mapping_file.txt",    sep="\t", quote="", row=1, head=T, comment.char="")gg_females <- rownames(ggmap)[ggmap$SEX == "female" & as.numeric(as.character(ggmap$AGE)) > 16 & ggmap$AGE != "None"]map <- read.table("/Users/pvangay/Dropbox/UMN/KnightsLab/IMP/Sequencing/sequences_090716/4. EMBALMER_output/mapping_merged.txt",    sep="\t", quote="", row=1, head=T, comment.char="")map$Age <- as.numeric(as.character(map$Age))map$Years.in.US <- as.numeric(as.character(map$Years.in.US))# let's only work with samples that are in both the mapping AND the dm filesvalid_samples <- intersect(rownames(dm), rownames(map))map <- map[valid_samples,]dm <- dm[valid_samples, valid_samples]US_adults <- rownames(map)[map$Ethnicity=="GAZ:United States of America" & map$Age > 16 & !is.na(map$Age)]US_adults <- intersect(US_adults,gg_females)Malawi_adults <- rownames(map)[map$Ethnicity=="GAZ:Malawi" & map$Age > 16 & !is.na(map$Age)]Venezuelan_adults <- rownames(map)[map$Ethnicity=="GAZ:Venezuela" & map$Age > 16 & !is.na(map$Age)]imp_samples <- rownames(map)[map$Ethnicity %in% c("Hmong", "Karen") & map$Years.in.US != 0 & map$Years.in.US < 20] US_born_samples <- rownames(map)[map$Ethnicity %in% c("Hmong") & map$Years.in.US == 0] # compare IMP against baseline of US-born HmongIMP_to_US <- NULLfor (i in 1:length(imp_samples)){    IMP_to_US[i] <- mean(as.numeric(dm[imp_samples[i], US_born_samples]))}names(IMP_to_US) <- imp_samples#
mean_data <- cbind(IMP_to_US, map[imp_samples, c("Years.in.US", "Ethnicity", "Age", "BMI","BMI.Class")])colnames(mean_data) <- c("Distance.to.US", "Years.in.US", "Ethnicity", "Age","BMI", "BMI.Class")# let's reset Years in US for the US-born to -10 so we can see this mean_data$Years.in.US[mean_data$Years.in.US==0] <- -1lookup <- c(19,17) # point typenames(lookup) <- sort(unique(mean_data$Ethnicity)) # let's Hmong to solid filled circle, Karen to filled trianglefinal.pch <- lookup[as.character(mean_data$Ethnicity)] # cols <- c("yellow","blue","green")# names(cols) <- sort(unique(mean_data$BMI.Class))# final.cols <- cols[as.character(mean_data$BMI.Class)]rbPal <- colorRampPalette(c('yellow','blue'))final.cols <- rbPal(10)[as.numeric(cut(mean_data$BMI, breaks = 10))]#
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US-born Hmong (Unweighted Unifrac)", main="Hmong, Karen vs. US-born Hmong"    , col=final.cols, pch=final.pch)m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)
legend(pch=c(19,17), x="topright", cex=.6, legend=c("Hmong", "Karen"))# add gradient image for age colorslegend_image <- as.raster(rbPal(10)[10:1])text(y=.555, x = c(30,35,40), labels = c("17","BMI","39"))rasterImage(legend_image, 30, .55, 30.7, .61, angle=270)
legend_image <- as.raster(rbPal(10)[10:1])text(y=.555, x = c(30,35,40), labels = c("17","BMI","39"))rasterImage(legend_image, 10, .55, 10.7, .61, angle=270)
rasterImage(legend_image, 10, .55, 10.5, .6, angle=270)
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US-born Hmong (Unweighted Unifrac)", main="Hmong, Karen vs. US-born Hmong"    , col=final.cols, pch=final.pch)m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)legend(pch=c(19,17), x="topright", cex=.6, legend=c("Hmong", "Karen"))# add gradient image for age colorslegend_image <- as.raster(rbPal(10)[10:1])text(y=.555, x = c(30,35,40), labels = c("17","BMI","39"))rasterImage(legend_image, 10, .55, 10.5, .6, angle=270)
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US-born Hmong (Unweighted Unifrac)", main="Hmong, Karen vs. US-born Hmong"    , col=final.cols, pch=final.pch)m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)legend(pch=c(19,17), x="topright", cex=.6, legend=c("Hmong", "Karen"))# add gradient image for age colorslegend_image <- as.raster(rbPal(10)[10:1])text(y=.555, x = c(30,35,40), labels = c("17","BMI","39"))rasterImage(legend_image, 10, .55, 10.5, .59, angle=270)
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US-born Hmong (Unweighted Unifrac)", main="Hmong, Karen vs. US-born Hmong"    , col=final.cols, pch=final.pch)m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)legend(pch=c(19,17), x="topright", cex=.6, legend=c("Hmong", "Karen"))# add gradient image for age colorslegend_image <- as.raster(rbPal(10)[10:1])text(y=.555, x = c(30,35,40), labels = c("17","BMI","39"))rasterImage(legend_image, 10, .57, 10.5, .59, angle=270)
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US-born Hmong (Unweighted Unifrac)", main="Hmong, Karen vs. US-born Hmong"    , col=final.cols, pch=final.pch)m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)legend(pch=c(19,17), x="topright", cex=.6, legend=c("Hmong", "Karen"))# add gradient image for age colorslegend_image <- as.raster(rbPal(10)[10:1])text(y=.555, x = c(30,35,40), labels = c("17","BMI","39"))rasterImage(legend_image, 12, .57, 12.5, .59, angle=270)
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US-born Hmong (Unweighted Unifrac)", main="Hmong, Karen vs. US-born Hmong"    , col=final.cols, pch=final.pch)m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)legend(pch=c(19,17), x="topright", cex=.6, legend=c("Hmong", "Karen"))# add gradient image for age colorslegend_image <- as.raster(rbPal(10)[10:1])text(y=.555, x = c(30,35,40), labels = c("17","BMI","39"))rasterImage(legend_image, 12, .56, 12.5, .59, angle=270)
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US-born Hmong (Unweighted Unifrac)", main="Hmong, Karen vs. US-born Hmong"    , col=final.cols, pch=final.pch)m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)legend(pch=c(19,17), x="topright", cex=.6, legend=c("Hmong", "Karen"))# add gradient image for age colorslegend_image <- as.raster(rbPal(10)[10:1])text(y=.555, x = c(30,35,40), labels = c("17","BMI","39"))rasterImage(legend_image, 12, .565, 12.5, .59, angle=270)
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US-born Hmong (Unweighted Unifrac)", main="Hmong, Karen vs. US-born Hmong"    , col=final.cols, pch=final.pch)m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)legend(pch=c(19,17), x="topright", cex=.6, legend=c("Hmong", "Karen"))# add gradient image for age colorslegend_image <- as.raster(rbPal(10)[10:1])text(y=.555, x = c(30,35,40), labels = c("17","BMI","39"))rasterImage(legend_image, 12, .555, 12.5, .59, angle=270)
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US-born Hmong (Unweighted Unifrac)", main="Hmong, Karen vs. US-born Hmong"    , col=final.cols, pch=final.pch)m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)legend(pch=c(19,17), x="topright", cex=.6, legend=c("Hmong", "Karen"))# add gradient image for age colorslegend_image <- as.raster(rbPal(10)[10:1])text(y=.555, x = c(30,35,40), labels = c("17","BMI","39"))rasterImage(legend_image, 12, .56, 12.5, .59, angle=270)
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US-born Hmong (Unweighted Unifrac)", main="Hmong, Karen vs. US-born Hmong"    , col=final.cols, pch=final.pch)m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)legend(pch=c(19,17), x="topright", cex=.6, legend=c("Hmong", "Karen"))# add gradient image for age colorslegend_image <- as.raster(rbPal(10)[10:1])text(y=.555, x = c(30,35,40), labels = c("17","BMI","39"))rasterImage(legend_image, 12, .55, 12.5, .57, angle=270)
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US-born Hmong (Unweighted Unifrac)", main="Hmong, Karen vs. US-born Hmong"    , col=final.cols, pch=final.pch)m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)legend(pch=c(19,17), x="topright", cex=.6, legend=c("Hmong", "Karen"))# add gradient image for age colorslegend_image <- as.raster(rbPal(10)[10:1])text(y=.555, x = c(30,35,40), labels = c("17","BMI","39"))rasterImage(legend_image, 13, .55, 13.5, .57, angle=270)
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US-born Hmong (Unweighted Unifrac)", main="Hmong, Karen vs. US-born Hmong"    , col=final.cols, pch=final.pch)m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)legend(pch=c(19,17), x="topright", cex=.6, legend=c("Hmong", "Karen"))# add gradient image for age colorslegend_image <- as.raster(rbPal(10)[10:1])text(y=.555, x = c(30,35,40), labels = c("17","BMI","39"))rasterImage(legend_image, 14, .55, 14.5, .57, angle=270)
max(mean_data$BMI)
min(mean_data$BMI)
text(y=.555, x = c(14,15,16), labels = c("17","BMI","39"))
text(y=.555, x = c(14,15,16), labels = c("17","BMI","39"), cex=.6)
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US-born Hmong (Unweighted Unifrac)", main="Hmong, Karen vs. US-born Hmong"    , col=final.cols, pch=final.pch)m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)legend(pch=c(19,17), x="topright", cex=.6, legend=c("Hmong", "Karen"))# add gradient image for age colorslegend_image <- as.raster(rbPal(10)[10:1])text(y=.555, x = c(14,15,16), labels = c("17","BMI","39"), cex=.6)rasterImage(legend_image, 14, .55, 14.5, .57, angle=270)
text(y=.5, x = c(14.7,15.2,15.7), labels = c("17","BMI","39"), cex=.6)
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US-born Hmong (Unweighted Unifrac)", main="Hmong, Karen vs. US-born Hmong"    , col=final.cols, pch=final.pch)m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)legend(pch=c(19,17), x="topright", cex=.6, legend=c("Hmong", "Karen"))# add gradient image for age colorslegend_image <- as.raster(rbPal(10)[10:1])text(y=.5, x = c(14.7,15.2,15.7), labels = c("17","BMI","39"), cex=.6)rasterImage(legend_image, 14, .55, 14.5, .57, angle=270)
text(y=.55, x = c(14.7,15.2,15.7), labels = c("17","BMI","39"), cex=.6)
text(y=.552, x = c(14.7,15.2,15.7), labels = c("17","BMI","39"), cex=.6)
text(y=.552, x = c(14,15.2,15.7), labels = c("17","BMI","39"), cex=.6)
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US-born Hmong (Unweighted Unifrac)", main="Hmong, Karen vs. US-born Hmong"    , col=final.cols, pch=final.pch)m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)legend(pch=c(19,17), x="topright", cex=.6, legend=c("Hmong", "Karen"))# add gradient image for age colorslegend_image <- as.raster(rbPal(10)[10:1])text(y=.552, x = c(14.2,15.4,15.7), labels = c("17","BMI","39"), cex=.6)rasterImage(legend_image, 14, .55, 14.5, .57, angle=270)
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US-born Hmong (Unweighted Unifrac)", main="Hmong, Karen vs. US-born Hmong"    , col=final.cols, pch=final.pch)m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)legend(pch=c(19,17), x="topright", cex=.6, legend=c("Hmong", "Karen"))# add gradient image for age colorslegend_image <- as.raster(rbPal(10)[10:1])text(y=.552, x = c(14.1,15,15.8), labels = c("17","BMI","39"), cex=.6)rasterImage(legend_image, 14, .55, 14.5, .57, angle=270)
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US-born Hmong (Unweighted Unifrac)", main="Hmong, Karen vs. US-born Hmong"    , col=final.cols, pch=final.pch)m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)legend(pch=c(19,17), x="topright", cex=.6, legend=c("Hmong", "Karen"))# add gradient image for age colorslegend_image <- as.raster(rbPal(10)[10:1])text(y=.552, x = c(14.1,15,15.8), labels = c("17","BMI","39"), cex=c(.6,.8,.6))rasterImage(legend_image, 14, .55, 14.5, .57, angle=270)
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US-born Hmong (Unweighted Unifrac)", main="Hmong, Karen vs. US-born Hmong"    , col=final.cols, pch=final.pch)m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)legend(pch=c(19,17), x="topright", cex=.8, legend=c("Hmong", "Karen"))# add gradient image for age colorslegend_image <- as.raster(rbPal(10)[10:1])text(y=.552, x = c(14.1,15,15.8), labels = c("17","BMI","39"), cex=c(.6,.8,.6))rasterImage(legend_image, 14, .55, 14.5, .57, angle=270)
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US-born Hmong (Unweighted Unifrac)", main="Hmong, Karen vs. US-born Hmong"    , col=final.cols, pch=final.pch)m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)legend(pch=c(19,17), x="topright", cex=.8, legend=c("Hmong", "Karen"))# add gradient image for age colorslegend_image <- as.raster(rbPal(10)[10:1])text(y=.55, x = c(14.1,15,15.8), labels = c("17","BMI","39"), cex=c(.6,.8,.6))rasterImage(legend_image, 14, .54, 14.5, .56, angle=270)
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US-born Hmong (Unweighted Unifrac)", main="Hmong, Karen vs. US-born Hmong"    , col=final.cols, pch=final.pch)m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)legend(pch=c(19,17), x="topright", cex=.8, legend=c("Hmong", "Karen"))# add gradient image for age colorslegend_image <- as.raster(rbPal(10)[10:1])text(y=.55, x = c(14.1,15,15.8), labels = c("17","BMI","39"), cex=c(.6,.8,.6))rasterImage(legend_image, 14, .55, 14.5, .56, angle=270)
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US-born Hmong (Unweighted Unifrac)", main="Hmong, Karen vs. US-born Hmong"    , col=final.cols, pch=final.pch)m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)legend(pch=c(19,17), x="topright", cex=.8, legend=c("Hmong", "Karen"))# add gradient image for age colorslegend_image <- as.raster(rbPal(10)[10:1])text(y=.55, x = c(14.1,15,15.8), labels = c("17","BMI","39"), cex=c(.6,.8,.6))rasterImage(legend_image, 14, .548, 14.5, .57, angle=270)
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US-born Hmong (Unweighted Unifrac)", main="Hmong, Karen vs. US-born Hmong"    , col=final.cols, pch=final.pch)m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)legend(pch=c(19,17), x="topright", cex=.8, legend=c("Hmong", "Karen"))# add gradient image for age colorslegend_image <- as.raster(rbPal(10)[10:1])text(y=.55, x = c(14.1,15,15.8), labels = c("17","BMI","39"), cex=c(.6,.8,.6))rasterImage(legend_image, 14, .548, 14.5, .56, angle=270)
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US-born Hmong (Unweighted Unifrac)", main="Hmong, Karen vs. US-born Hmong"    , col=final.cols, pch=final.pch)m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)legend(pch=c(19,17), x="topright", cex=.8, legend=c("Hmong", "Karen"))# add gradient image for age colorslegend_image <- as.raster(rbPal(10)[10:1])text(y=.55, x = c(14.1,15,15.8), labels = c("17","BMI","39"), cex=c(.6,.8,.6))rasterImage(legend_image, 14, .548, 14.3, .57, angle=270)
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US-born Hmong (Unweighted Unifrac)", main="Hmong, Karen vs. US-born Hmong"    , col=final.cols, pch=final.pch)m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)legend(pch=c(19,17), x="topright", cex=.8, legend=c("Hmong", "Karen"))# add gradient image for age colorslegend_image <- as.raster(rbPal(10)[10:1])text(y=.55, x = c(14.1,15,15.8), labels = c("17","BMI","39"), cex=c(.6,.8,.6))rasterImage(legend_image, 14, .548, 14.25, .57, angle=270)
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US-born Hmong (Unweighted Unifrac)", main="Hmong, Karen vs. US-born Hmong"    , col=final.cols, pch=final.pch)m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)legend(pch=c(19,17), x="topright", cex=.8, legend=c("Hmong", "Karen"))# add gradient image for age colorslegend_image <- as.raster(rbPal(10)[10:1])text(y=.55, x = c(14.1,15,15.8), labels = c("17","BMI","39"), cex=c(.6,.8,.6))rasterImage(legend_image, 14, .548, 14.2, .57, angle=270)
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US-born Hmong (Unweighted Unifrac)", main="Hmong, Karen vs. US-born Hmong"    , col=final.cols, pch=final.pch)m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)legend(pch=c(19,17), x="topright", cex=.8, legend=c("Hmong", "Karen"))# add gradient image for age colorslegend_image <- as.raster(rbPal(10)[10:1])text(y=.55, x = c(14.1,15,15.8), labels = c("17","BMI","39"), cex=c(.6,.8,.6))rasterImage(legend_image, 14, .548, 14.2, .565, angle=270)
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US-born Hmong (Unweighted Unifrac)", main="Hmong, Karen vs. US-born Hmong"    , col=final.cols, pch=final.pch)m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)legend(pch=c(19,17), x="topright", cex=.8, legend=c("Hmong", "Karen"))# add gradient image for age colorslegend_image <- as.raster(rbPal(10)[10:1])text(y=.55, x = c(14.1,15,15.8), labels = c("17","BMI","39"), cex=c(.6,.8,.6))rasterImage(legend_image, 14, .548, 14.2, .568, angle=270)
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US-born Hmong (Unweighted Unifrac)", main="Hmong, Karen vs. US-born Hmong"    , col=final.cols, pch=final.pch)m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)legend(pch=c(19,17), x="topright", cex=.8, legend=c("Hmong", "Karen"))# add gradient image for age colorslegend_image <- as.raster(rbPal(10)[10:1])text(y=.55, x = c(14.1,15,15.8), labels = c("17","BMI","39"), cex=c(.6,.8,.6))rasterImage(legend_image, 14, .548, 14.2, .569, angle=270)
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US-born Hmong (Unweighted Unifrac)", main="Hmong, Karen vs. US-born Hmong"    , col=final.cols, pch=final.pch)m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)legend(pch=c(19,17), x="topright", cex=.8, legend=c("Hmong", "Karen"))# add gradient image for age colorslegend_image <- as.raster(rbPal(10)[10:1])text(y=.55, x = c(14.1,15,15.8), labels = c("17","BMI","39"), cex=c(.6,.8,.6))rasterImage(legend_image, 14, .548, 14.2, .5685, angle=270)
legend(pch=c(19,17), x="topright", cex=.8, legend=c("Hmong", "Karen", "","",""))
legend(pch=c(19,17), x="topright", cex=.8, legend=c("Hmong", "Karen", "",""))
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US-born Hmong (Unweighted Unifrac)", main="Hmong, Karen vs. US-born Hmong"    , col=final.cols, pch=final.pch)m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)legend(pch=c(19,17), x="topright", cex=.8, legend=c("Hmong", "Karen", "",""), bty="n")# add gradient image for age colorslegend_image <- as.raster(rbPal(10)[10:1])text(y=.55, x = c(14.1,15,15.8), labels = c("17","BMI","39"), cex=c(.6,.8,.6))rasterImage(legend_image, 14, .548, 14.2, .5685, angle=270)
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US-born Hmong (Unweighted Unifrac)", main="Hmong, Karen vs. US-born Hmong"    , col=final.cols, pch=final.pch)m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)legend(pch=c(19,17), col=c("black","black","white"), x="topright", cex=.8, legend=c("Hmong", "Karen", ""), bty="n")# add gradient image for age colorslegend_image <- as.raster(rbPal(10)[10:1])text(y=.55, x = c(14.1,15,15.8), labels = c("17","BMI","39"), cex=c(.6,.8,.6))
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US-born Hmong (Unweighted Unifrac)", main="Hmong, Karen vs. US-born Hmong"    , col=final.cols, pch=final.pch)m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)legend(pch=c(19,17), col=c("black","black","white"), x="topright", cex=.8, legend=c("Hmong", "Karen", ""), bty="n")# add gradient image for age colorslegend_image <- as.raster(rbPal(10)[10:1])text(y=.55, x = c(14.1,15,15.8), labels = c("17","BMI","39"), cex=c(.6,.8,.6))rasterImage(legend_image, 14, .548, 14.2, .5685, angle=270)
text(y=.555, x = c(14.1,15,15.8), labels = c("17","BMI","39"), cex=c(.6,.8,.6))
text(y=.553, x = c(14.1,15,15.8), labels = c("17","BMI","39"), cex=c(.6,.8,.6))
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US-born Hmong (Unweighted Unifrac)", main="Hmong, Karen vs. US-born Hmong"    , col=final.cols, pch=final.pch)m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)legend(pch=c(19,17), col=c("black","black","white"), x="topright", cex=.8, legend=c("Hmong", "Karen", ""), bty="n")# add gradient image for age colorslegend_image <- as.raster(rbPal(10)[10:1])text(y=.553, x = c(14.1,15,15.8), labels = c("17","BMI","39"), cex=c(.6,.8,.6))rasterImage(legend_image, 14, .548, 14.2, .5685, angle=270)
rasterImage(legend_image, 14, .55, 14.2, .5685, angle=270)
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US-born Hmong (Unweighted Unifrac)", main="Hmong, Karen vs. US-born Hmong"    , col=final.cols, pch=final.pch)m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)legend(pch=c(19,17), col=c("black","black","white"), x="topright", cex=.8, legend=c("Hmong", "Karen", ""), bty="n")# add gradient image for age colorslegend_image <- as.raster(rbPal(10)[10:1])text(y=.553, x = c(14.1,15,15.8), labels = c("17","BMI","39"), cex=c(.6,.8,.6))rasterImage(legend_image, 14, .55, 14.2, .57, angle=270)
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US-born Hmong (Unweighted Unifrac)", main="Foreign-born Hmong and Karen become more similar to US-born Hmong over time"    , col=final.cols, pch=final.pch)m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)legend(pch=c(19,17), col=c("black","black","white"), x="topright", cex=.8, legend=c("Hmong", "Karen", ""), bty="n")# add gradient image for age colorslegend_image <- as.raster(rbPal(10)[10:1])text(y=.553, x = c(14.1,15,15.8), labels = c("17","BMI","39"), cex=c(.6,.8,.6))rasterImage(legend_image, 14, .55, 14.2, .57, angle=270)
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US-born Hmong (Unweighted Unifrac)", main="Foreign-born Hmong and Karen gut microbiomes westernize over time"    , col=final.cols, pch=final.pch)m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)legend(pch=c(19,17), col=c("black","black","white"), x="topright", cex=.8, legend=c("Hmong", "Karen", ""), bty="n")# add gradient image for age colorslegend_image <- as.raster(rbPal(10)[10:1])text(y=.553, x = c(14.1,15,15.8), labels = c("17","BMI","39"), cex=c(.6,.8,.6))rasterImage(legend_image, 14, .55, 14.2, .57, angle=270)
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US-born Hmong (Unweighted Unifrac)", main="Foreign-born Hmong and Karen become more like US-born"    , col=final.cols, pch=final.pch)m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)legend(pch=c(19,17), col=c("black","black","white"), x="topright", cex=.8, legend=c("Hmong", "Karen", ""), bty="n")# add gradient image for age colorslegend_image <- as.raster(rbPal(10)[10:1])text(y=.553, x = c(14.1,15,15.8), labels = c("17","BMI","39"), cex=c(.6,.8,.6))rasterImage(legend_image, 14, .55, 14.2, .57, angle=270)
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US-born Hmong (Unweighted Unifrac)", main="Foreign-born Hmong and Karen \nbecome similar to US-born over time"    , col=final.cols, pch=final.pch)m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)legend(pch=c(19,17), col=c("black","black","white"), x="topright", cex=.8, legend=c("Hmong", "Karen", ""), bty="n")# add gradient image for age colorslegend_image <- as.raster(rbPal(10)[10:1])text(y=.553, x = c(14.1,15,15.8), labels = c("17","BMI","39"), cex=c(.6,.8,.6))rasterImage(legend_image, 14, .55, 14.2, .57, angle=270)
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US-born Hmong (Unweighted Unifrac)", main="Foreign-born Hmong and Karen \nbecome similar to US-born over time"    , col=final.cols, pch=final.pch)m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)legend(pch=c(19,17), col=c("black","black","white","white"), x="topright", cex=.8, legend=c("Hmong", "Karen", "", ""))# add gradient image for age colorslegend_image <- as.raster(rbPal(10)[10:1])text(y=.553, x = c(14.1,15,15.8), labels = c("17","BMI","39"), cex=c(.6,.8,.6))rasterImage(legend_image, 14, .55, 14.2, .57, angle=270)
text(y=.553, x = c(14.2,15,15.8), labels = c("17","BMI","39"), cex=c(.6,.8,.6))
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US-born Hmong (Unweighted Unifrac)", main="Foreign-born Hmong and Karen \nbecome similar to US-born over time"    , col=final.cols, pch=final.pch)m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)legend(pch=c(19,17), col=c("black","black","white","white"), x="topright", cex=.8, legend=c("Hmong", "Karen", "", ""))# add gradient image for age colorslegend_image <- as.raster(rbPal(10)[10:1])text(y=.553, x = c(14.2,15,15.8), labels = c("17","BMI","39"), cex=c(.6,.8,.6))rasterImage(legend_image, 14.1, .55, 14.2, .57, angle=270)
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US-born Hmong (Unweighted Unifrac)", main="Foreign-born Hmong and Karen \nbecome similar to US-born over time"    , col=final.cols, pch=final.pch)m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)legend(pch=c(19,17), col=c("black","black","white","white"), x="topright", cex=.8, legend=c("Hmong", "Karen", "", ""))# add gradient image for age colorslegend_image <- as.raster(rbPal(10)[10:1])text(y=.553, x = c(14.2,15,15.8), labels = c("17","BMI","39"), cex=c(.6,.8,.6))rasterImage(legend_image, 14.1, .55, 14.3, .56, angle=270)
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US-born Hmong (Unweighted Unifrac)", main="Foreign-born Hmong and Karen \nbecome similar to US-born over time"    , col=final.cols, pch=final.pch)m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)legend(pch=c(19,17), col=c("black","black","white","white"), x="topright", cex=.8, legend=c("Hmong", "Karen", "", ""))# add gradient image for age colorslegend_image <- as.raster(rbPal(10)[10:1])text(y=.553, x = c(14.2,15,15.8), labels = c("17","BMI","39"), cex=c(.6,.8,.6))rasterImage(legend_image, 14.1, .55, 14.3, .565, angle=270)
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US-born Hmong (Unweighted Unifrac)", main="Foreign-born Hmong and Karen \nbecome similar to US-born over time"    , col=final.cols, pch=final.pch)m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)legend(pch=c(19,17), col=c("black","black","white","white"), x="topright", cex=.8, legend=c("Hmong", "Karen", "", ""))# add gradient image for age colorslegend_image <- as.raster(rbPal(10)[10:1])text(y=.553, x = c(14.2,15,15.8), labels = c("17","BMI","39"), cex=c(.6,.8,.6))rasterImage(legend_image, 14.1, .55, 14.3, .568, angle=270)
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US-born Hmong (Unweighted Unifrac)", main="Foreign-born Hmong and Karen \nbecome similar to US-born over time"    , col=final.cols, pch=final.pch)m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)legend(pch=c(19,17), col=c("black","black","white","white"), x="topright", cex=.8, legend=c("Hmong", "Karen", "", ""))# add gradient image for age colorslegend_image <- as.raster(rbPal(10)[10:1])text(y=.553, x = c(14.2,15,15.8), labels = c("17","BMI","39"), cex=c(.6,.8,.6))rasterImage(legend_image, 14.1, .55, 14.3, .569, angle=270)
summary(m)
m
summary(m)$p.value
summary(m)
s <- summary(m)
s$r.squared
s$sigma
coef(m)
coef(s)
coef(s)[2,4]
s <- summary(m)rsquared <- s$r.squaredpval <- coef(s)[2,4]text(x=14.2, y=c(.47,.48), labels=c(pval, rsquared), cex=.5)
text(x=14.2, y=c(.47,.48), labels=c(paste("pval =",pval), paste("R2 =",rsquared)), cex=.5)
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US-born Hmong (Unweighted Unifrac)", main="Foreign-born Hmong and Karen \nbecome similar to US-born over time"    , col=final.cols, pch=final.pch)m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)legend(pch=c(19,17), col=c("black","black","white","white"), x="topright", cex=.8, legend=c("Hmong", "Karen", "", ""))# add gradient image for age colorslegend_image <- as.raster(rbPal(10)[10:1])text(y=.553, x = c(14.2,15,15.8), labels = c("17","BMI","39"), cex=c(.6,.8,.6))rasterImage(legend_image, 14.1, .55, 14.3, .569, angle=270)# plot Rsquared and p values <- summary(m)rsquared <- s$r.squaredpval <- coef(s)[2,4]text(x=14.2, y=c(.47,.48), labels=c(paste("pval =",round(pval,3)), paste("R2 =",round(rsquared,3))), cex=.5)
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US-born Hmong (Unweighted Unifrac)", main="Foreign-born Hmong and Karen \nbecome similar to US-born over time"    , col=final.cols, pch=final.pch)m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)legend(pch=c(19,17), col=c("black","black","white","white"), x="topright", cex=.8, legend=c("Hmong", "Karen", "", ""))# add gradient image for age colorslegend_image <- as.raster(rbPal(10)[10:1])text(y=.553, x = c(14.2,15,15.8), labels = c("17","BMI","39"), cex=c(.6,.8,.6))rasterImage(legend_image, 14.1, .55, 14.3, .569, angle=270)# plot Rsquared and p values <- summary(m)rsquared <- s$r.squaredpval <- coef(s)[2,4]text(x=14.2, y=c(.47,.48), labels=c(paste("pval =",round(pval,3)), paste("R2 =",round(rsquared,3))), cex=.5)
text(x=14.2, y=c(.47,.475), labels=c(paste("pval =",round(pval,3)), paste("R2 =",round(rsquared,3))), cex=.7)
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US-born Hmong (Unweighted Unifrac)", main="Foreign-born Hmong and Karen \nbecome similar to US-born over time"    , col=final.cols, pch=final.pch)m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)legend(pch=c(19,17), col=c("black","black","white","white"), x="topright", cex=.8, legend=c("Hmong", "Karen", "", ""))# add gradient image for age colorslegend_image <- as.raster(rbPal(10)[10:1])text(y=.553, x = c(14.2,15,15.8), labels = c("17","BMI","39"), cex=c(.6,.8,.6))rasterImage(legend_image, 14.1, .55, 14.3, .569, angle=270)# plot Rsquared and p values <- summary(m)rsquared <- s$r.squaredpval <- coef(s)[2,4]text(x=14.2, y=c(.47,.475), labels=c(paste("pval =",round(pval,3)), paste("R2 =",round(rsquared,3))), cex=.7)
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US-born Hmong (Unweighted Unifrac)", main="Foreign-born Hmong and Karen \nbecome similar to US-born over time"    , col=final.cols, pch=final.pch)m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)legend(pch=c(19,17), col=c("black","black","white","white"), x="topright", cex=.8, legend=c("Hmong", "Karen", "", ""))# add gradient image for age colorslegend_image <- as.raster(rbPal(10)[10:1])text(y=.553, x = c(14.2,15,15.8), labels = c("17","BMI","39"), cex=c(.6,.8,.6))rasterImage(legend_image, 14.1, .55, 14.3, .569, angle=270)# plot Rsquared and p values <- summary(m)rsquared <- s$r.squaredpval <- coef(s)[2,4]text(x=14.2, y=c(.47,.473), labels=c(paste("pval =",round(pval,3)), paste("R2 =",round(rsquared,3))), cex=.7)
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US-born Hmong (Unweighted Unifrac)", main="Foreign-born Hmong and Karen \nbecome similar to US-born over time"    , col=final.cols, pch=final.pch)m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)legend(pch=c(19,17), col=c("black","black","white","white"), x="topright", cex=.8, legend=c("Hmong", "Karen", "", ""))# add gradient image for age colorslegend_image <- as.raster(rbPal(10)[10:1])text(y=.553, x = c(14.2,15,15.8), labels = c("17","BMI","39"), cex=c(.6,.8,.6))rasterImage(legend_image, 14.1, .55, 14.3, .569, angle=270)# plot Rsquared and p values <- summary(m)rsquared <- s$r.squaredpval <- coef(s)[2,4]text(x=14.2, y=c(.47,.474), labels=c(paste("pval =",round(pval,3)), paste("R2 =",round(rsquared,3))), cex=.7)
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US-born Hmong (Unweighted Unifrac)", main="Foreign-born Hmong and Karen \nbecome similar to US-born over time"    , col=final.cols, pch=final.pch)m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)legend(pch=c(19,17), col=c("black","black","white","white"), x="topright", cex=.8, legend=c("Hmong", "Karen", "", ""))# add gradient image for age colorslegend_image <- as.raster(rbPal(10)[10:1])text(y=.553, x = c(14.2,15,15.8), labels = c("17","BMI","39"), cex=c(.6,.8,.6))rasterImage(legend_image, 14.1, .55, 14.3, .569, angle=270)# plot Rsquared and p values <- summary(m)rsquared <- s$r.squaredpval <- coef(s)[2,4]text(x=14.2, y=c(.47,.474), labels=c(paste("P =",round(pval,3)), paste("R2 =",round(rsquared,3))), cex=.7)
plot(mean_data$Years.in.US, mean_data$Distance.to.US, xlab="Years in US", ylab="Distance to US-born Hmong (Unweighted Unifrac)", main="Foreign-born Hmong and Karen \nbecome similar to US-born over time"    , col=final.cols, pch=final.pch)m <- lm(mean_data$Distance.to.US~mean_data$Years.in.US)abline(m)legend(pch=c(19,17), col=c("black","black","white","white"), x="topright", cex=.8, legend=c("Hmong", "Karen", "", ""))# add gradient image for age colorslegend_image <- as.raster(rbPal(10)[10:1])text(y=.553, x = c(14.2,15,15.8), labels = c("17","BMI","39"), cex=c(.6,.8,.6))rasterImage(legend_image, 14.1, .55, 14.3, .569, angle=270)# plot Rsquared and p values <- summary(m)rsquared <- s$r.squaredpval <- coef(s)[2,4]text(x=14.2, y=c(.47,.474), labels=c(paste("P =",round(pval,4)), paste("R2 =",round(rsquared,4))), cex=.7)
alphadiv <- read.table("/Users/pvangay/Dropbox/UMN/KnightsLab/IMP/Sequencing/sequences_090716/4. EMBALMER_output/alpha_div.txt",    sep="\t", quote="", row=1, head=T, comment.char="")
alphadiv
alphadiv <- read.table("/Users/pvangay/Dropbox/UMN/KnightsLab/IMP/Sequencing/sequences_090716/4. EMBALMER_output/alpha_div.txt",    sep="\t", quote="", row=1, head=T, comment.char="")alphadiv <- alphadiv[imp_samples,]mean_data <- cbind(mean_data,alphadiv)
head(mean_data)
plot(mean_data$Years.in.US, mean_data$alphadiv)
imp_samples <- rownames(map)[map$Ethnicity %in% c("Hmong", "Karen") & map$Years.in.US != 0] mean_data <- cbind(IMP_to_US, map[imp_samples, c("Years.in.US", "Ethnicity", "Age", "BMI","BMI.Class")])colnames(mean_data) <- c("Distance.to.US", "Years.in.US", "Ethnicity", "Age","BMI", "BMI.Class")alphadiv <- read.table("/Users/pvangay/Dropbox/UMN/KnightsLab/IMP/Sequencing/sequences_090716/4. EMBALMER_output/alpha_div.txt",    sep="\t", quote="", row=1, head=T, comment.char="")alphadiv <- alphadiv[imp_samples,]mean_data <- cbind(mean_data,alphadiv)plot(mean_data$Years.in.US, mean_data$alphadiv)
imp_samples <- rownames(map)[map$Ethnicity %in% c("Hmong", "Karen") & map$Years.in.US != 0]
imp_samples <- rownames(map)[map$Ethnicity %in% c("Hmong", "Karen") & map$Years.in.US != 0] alphadiv <- read.table("/Users/pvangay/Dropbox/UMN/KnightsLab/IMP/Sequencing/sequences_090716/4. EMBALMER_output/alpha_div.txt",    sep="\t", quote="", row=1, head=T, comment.char="")alphadiv <- alphadiv[imp_samples,]data <- cbind(map[imp_samples, c("Years.in.US", "Ethnicity", "Age", "BMI","BMI.Class")], alphadiv)colnames(data) <- c("Distance.to.US", "Years.in.US", "Ethnicity", "Age","BMI", "BMI.Class", "alphadiv")plot(mean_data$Years.in.US, mean_data$alphadiv)
colnames(data) <- c("Years.in.US", "Ethnicity", "Age","BMI", "BMI.Class", "alphadiv")
plot(mean_data$Years.in.US, mean_data$alphadiv)
imp_samples <- rownames(map)[map$Ethnicity %in% c("Hmong", "Karen") & map$Years.in.US != 0] alphadiv <- read.table("/Users/pvangay/Dropbox/UMN/KnightsLab/IMP/Sequencing/sequences_090716/4. EMBALMER_output/alpha_div.txt",    sep="\t", quote="", row=1, head=T, comment.char="")alphadiv <- alphadiv[imp_samples,]data <- cbind(map[imp_samples, c("Years.in.US", "Ethnicity", "Age", "BMI","BMI.Class")], alphadiv)colnames(data) <- c("Years.in.US", "Ethnicity", "Age","BMI", "BMI.Class", "alphadiv")plot(data$Years.in.US, data$alphadiv)
alphadiv[US_born_samples]
alphadiv[US_born_samples,1]
alphadiv
alphadiv0 <- read.table("/Users/pvangay/Dropbox/UMN/KnightsLab/IMP/Sequencing/sequences_090716/4. EMBALMER_output/alpha_div.txt",    sep="\t", quote="", row=1, head=T, comment.char="")
alphadiv0[US_born_samples,1]
plot(data$Years.in.US, data$alphadiv)
plot(data$Years.in.US, data$alphadiv, xlab="Years in US", ylab="Number of Observed OTUs", main="Alpha Diversity",    col=cols2, pch=pch2)points(rep(-1, length(US_born_samples)), alphadiv0[US_born_samples,1])
imp_samples2 <- rownames(map)[map$Ethnicity %in% c("Hmong", "Karen") & map$Years.in.US != 0] alphadiv0 <- read.table("/Users/pvangay/Dropbox/UMN/KnightsLab/IMP/Sequencing/sequences_090716/4. EMBALMER_output/alpha_div.txt",    sep="\t", quote="", row=1, head=T, comment.char="")alphadiv <- alphadiv0[imp_samples2,]data <- cbind(map[imp_samples2, c("Years.in.US", "Ethnicity", "Age", "BMI","BMI.Class")], alphadiv)colnames(data) <- c("Years.in.US", "Ethnicity", "Age","BMI", "BMI.Class", "alphadiv")cols2 <- rbPal(10)[as.numeric(cut(data$BMI, breaks = 10))]pch2 <- lookup[as.character(data$Ethnicity)] plot(data$Years.in.US, data$alphadiv, xlab="Years in US", ylab="Number of Observed OTUs", main="Alpha Diversity",    col=cols2, pch=pch2)points(rep(-1, length(US_born_samples)), alphadiv0[US_born_samples,1])
imp_samples2 <- rownames(map)[map$Ethnicity %in% c("Hmong", "Karen") & map$Years.in.US != 0] alphadiv0 <- read.table("/Users/pvangay/Dropbox/UMN/KnightsLab/IMP/Sequencing/sequences_090716/4. EMBALMER_output/alpha_div.txt",    sep="\t", quote="", row=1, head=T, comment.char="")alphadiv <- alphadiv0[imp_samples2,]data <- cbind(map[imp_samples2, c("Years.in.US", "Ethnicity", "Age", "BMI","BMI.Class")], alphadiv)colnames(data) <- c("Years.in.US", "Ethnicity", "Age","BMI", "BMI.Class", "alphadiv")cols2 <- rbPal(10)[as.numeric(cut(data$BMI, breaks = 10))]pch2 <- lookup[as.character(data$Ethnicity)] plot(data$Years.in.US, data$alphadiv, xlab="Years in US", ylab="Number of Observed OTUs", main="Alpha Diversity",    col=cols2, pch=pch2)points(rep(-1, length(US_born_samples)), alphadiv0[US_born_samples,1])
imp_samples2 <- rownames(map)[map$Ethnicity %in% c("Karen") & map$Years.in.US != 0] alphadiv0 <- read.table("/Users/pvangay/Dropbox/UMN/KnightsLab/IMP/Sequencing/sequences_090716/4. EMBALMER_output/alpha_div.txt",    sep="\t", quote="", row=1, head=T, comment.char="")alphadiv <- alphadiv0[imp_samples2,]data <- cbind(map[imp_samples2, c("Years.in.US", "Ethnicity", "Age", "BMI","BMI.Class")], alphadiv)colnames(data) <- c("Years.in.US", "Ethnicity", "Age","BMI", "BMI.Class", "alphadiv")cols2 <- rbPal(10)[as.numeric(cut(data$BMI, breaks = 10))]pch2 <- lookup[as.character(data$Ethnicity)] plot(data$Years.in.US, data$alphadiv, xlab="Years in US", ylab="Number of Observed OTUs", main="Alpha Diversity",    col=cols2, pch=pch2)
imp_samples2 <- rownames(map)[map$Ethnicity %in% c("Hmong") & map$Years.in.US != 0] alphadiv0 <- read.table("/Users/pvangay/Dropbox/UMN/KnightsLab/IMP/Sequencing/sequences_090716/4. EMBALMER_output/alpha_div.txt",    sep="\t", quote="", row=1, head=T, comment.char="")alphadiv <- alphadiv0[imp_samples2,]data <- cbind(map[imp_samples2, c("Years.in.US", "Ethnicity", "Age", "BMI","BMI.Class")], alphadiv)colnames(data) <- c("Years.in.US", "Ethnicity", "Age","BMI", "BMI.Class", "alphadiv")cols2 <- rbPal(10)[as.numeric(cut(data$BMI, breaks = 10))]pch2 <- lookup[as.character(data$Ethnicity)] plot(data$Years.in.US, data$alphadiv, xlab="Years in US", ylab="Number of Observed OTUs", main="Alpha Diversity",    col=cols2, pch=pch2)points(rep(-1, length(US_born_samples)), alphadiv0[US_born_samples,1])
imp_samples2 <- rownames(map)[map$Ethnicity %in% c("Hmong","Karen") & map$Years.in.US != 0] alphadiv0 <- read.table("/Users/pvangay/Dropbox/UMN/KnightsLab/IMP/Sequencing/sequences_090716/4. EMBALMER_output/alpha_div.txt",    sep="\t", quote="", row=1, head=T, comment.char="")alphadiv <- alphadiv0[imp_samples2,]data <- cbind(map[imp_samples2, c("Years.in.US", "Ethnicity", "Age", "BMI","BMI.Class")], alphadiv)colnames(data) <- c("Years.in.US", "Ethnicity", "Age","BMI", "BMI.Class", "alphadiv")cols2 <- rbPal(10)[as.numeric(cut(data$BMI, breaks = 10))]pch2 <- lookup[as.character(data$Ethnicity)] plot(data$Years.in.US, data$alphadiv, xlab="Years in US", ylab="Number of Observed OTUs", main="Alpha Diversity",    col=cols2, pch=pch2)points(rep(-1, length(US_born_samples)), alphadiv0[US_born_samples,1])
all_samples <- rownames(map)[map$Ethnicity %in% c("Hmong","Karen")] immigrants <- rownames(map)[map$Ethnicity %in% c("Hmong","Karen") & map$Years.in.US!=0] alphadiv0 <- read.table("/Users/pvangay/Dropbox/UMN/KnightsLab/IMP/Sequencing/sequences_090716/4. EMBALMER_output/alpha_div.txt",    sep="\t", quote="", row=1, head=T, comment.char="")alphadiv <- alphadiv0[all_samples,]data <- cbind(map[all_samples, c("Years.in.US", "Ethnicity", "Age", "BMI","BMI.Class")], alphadiv)colnames(data) <- c("Years.in.US", "Ethnicity", "Age","BMI", "BMI.Class", "alphadiv")cols2 <- rbPal(10)[as.numeric(cut(c(data$BMI,, breaks = 10))]names(cols2) <- rownames(data)pch2 <- lookup[as.character(data$Ethnicity)] names(pch2) <- rownames(data)plot(data[immigrants,"Years.in.US"], data[immigrants,"alphadiv"], xlab="Years in US", ylab="Number of Observed OTUs", main="Alpha Diversity",    col=cols2[immigrants], pch=pch2[immigrants])points(rep(-1, length(US_born_samples)), data[US_born_samples,"alphadiv",col=cols2[US_born_samples])
all_samples <- rownames(map)[map$Ethnicity %in% c("Hmong","Karen")] immigrants <- rownames(map)[map$Ethnicity %in% c("Hmong","Karen") & map$Years.in.US!=0] alphadiv0 <- read.table("/Users/pvangay/Dropbox/UMN/KnightsLab/IMP/Sequencing/sequences_090716/4. EMBALMER_output/alpha_div.txt",    sep="\t", quote="", row=1, head=T, comment.char="")alphadiv <- alphadiv0[all_samples,]data <- cbind(map[all_samples, c("Years.in.US", "Ethnicity", "Age", "BMI","BMI.Class")], alphadiv)colnames(data) <- c("Years.in.US", "Ethnicity", "Age","BMI", "BMI.Class", "alphadiv")cols2 <- rbPal(10)[as.numeric(cut(c(data$BMI,, breaks = 10))]names(cols2) <- rownames(data)pch2 <- lookup[as.character(data$Ethnicity)] names(pch2) <- rownames(data)plot(data[immigrants,"Years.in.US"], data[immigrants,"alphadiv"], xlab="Years in US", ylab="Number of Observed OTUs", main="Alpha Diversity",    col=cols2[immigrants], pch=pch2[immigrants])points(rep(-1, length(US_born_samples)), data[US_born_samples,"alphadiv"],col=cols2[US_born_samples])
cols2 <- rbPal(10)[as.numeric(cut(data$BMI, breaks = 10))]names(cols2) <- rownames(data)pch2 <- lookup[as.character(data$Ethnicity)] names(pch2) <- rownames(data)plot(data[immigrants,"Years.in.US"], data[immigrants,"alphadiv"], xlab="Years in US", ylab="Number of Observed OTUs", main="Alpha Diversity",    col=cols2[immigrants], pch=pch2[immigrants])points(rep(-1, length(US_born_samples)), data[US_born_samples,"alphadiv"],col=cols2[US_born_samples])
# plot alpha diversityall_samples <- rownames(map)[map$Ethnicity %in% c("Hmong","Karen")] immigrants <- rownames(map)[map$Ethnicity %in% c("Hmong","Karen") & map$Years.in.US!=0] alphadiv0 <- read.table("/Users/pvangay/Dropbox/UMN/KnightsLab/IMP/Sequencing/sequences_090716/4. EMBALMER_output/alpha_div.txt",    sep="\t", quote="", row=1, head=T, comment.char="")alphadiv <- alphadiv0[all_samples,]data <- cbind(map[all_samples, c("Years.in.US", "Ethnicity", "Age", "BMI","BMI.Class")], alphadiv)colnames(data) <- c("Years.in.US", "Ethnicity", "Age","BMI", "BMI.Class", "alphadiv")cols2 <- rbPal(10)[as.numeric(cut(data$BMI, breaks = 10))]names(cols2) <- rownames(data)pch2 <- lookup[as.character(data$Ethnicity)] names(pch2) <- rownames(data)plot(data[immigrants,"Years.in.US"], data[immigrants,"alphadiv"], xlab="Years in US", ylab="Number of Observed OTUs", main="Alpha Diversity",    col=cols2[immigrants], pch=pch2[immigrants])points(rep(-1, length(US_born_samples)), data[US_born_samples,"alphadiv"],col=cols2[US_born_samples], pch=19, bg="black")
all_samples <- rownames(map)[map$Ethnicity %in% c("Hmong","Karen")] immigrants <- rownames(map)[map$Ethnicity %in% c("Hmong","Karen") & map$Years.in.US!=0] alphadiv0 <- read.table("/Users/pvangay/Dropbox/UMN/KnightsLab/IMP/Sequencing/sequences_090716/4. EMBALMER_output/alpha_div.txt",    sep="\t", quote="", row=1, head=T, comment.char="")alphadiv <- alphadiv0[all_samples,]data <- cbind(map[all_samples, c("Years.in.US", "Ethnicity", "Age", "BMI","BMI.Class")], alphadiv)colnames(data) <- c("Years.in.US", "Ethnicity", "Age","BMI", "BMI.Class", "alphadiv")cols2 <- rbPal(10)[as.numeric(cut(data$BMI, breaks = 10))]names(cols2) <- rownames(data)pch2 <- lookup[as.character(data$Ethnicity)] names(pch2) <- rownames(data)plot(data[immigrants,"Years.in.US"], data[immigrants,"alphadiv"], xlab="Years in US", ylab="Number of Observed OTUs", main="Alpha Diversity",    col=cols2[immigrants], pch=pch2[immigrants])points(rep(-1, length(US_born_samples)), data[US_born_samples,"alphadiv"],bg=cols2[US_born_samples], pch=21, col="black")
legend(pch=c(19,17), col=c("black","black","white","white"), x="topright", cex=.8, legend=c("Hmong", "Karen", "", ""))# add gradient image for age colorslegend_image <- as.raster(rbPal(10)[10:1])text(y=400, x = c(35.2,36,36.8), labels = c("17","BMI","43"), cex=c(.6,.8,.6))rasterImage(legend_image, 30.1, 400, 31.3, 410, angle=270)
text(y=400, x = c(38,39,40), labels = c("17","BMI","43"), cex=c(.6,.8,.6))
plot(data[immigrants,"Years.in.US"], data[immigrants,"alphadiv"], xlab="Years in US", ylab="Number of Observed OTUs", main="Alpha Diversity",    col=cols2[immigrants], pch=pch2[immigrants])points(rep(-1, length(US_born_samples)), data[US_born_samples,"alphadiv"],bg=cols2[US_born_samples], pch=21, col="black")legend(pch=c(19,17), col=c("black","black","white","white"), x="topright", cex=.8, legend=c("Hmong", "Karen", "", ""))# add gradient image for age colorslegend_image <- as.raster(rbPal(10)[10:1])text(y=400, x = c(38,39,40), labels = c("17","BMI","43"), cex=c(.6,.8,.6))rasterImage(legend_image, 30.1, 400, 31.3, 410, angle=270)
plot(data[immigrants,"Years.in.US"], data[immigrants,"alphadiv"], xlab="Years in US", ylab="Number of Observed OTUs", main="Alpha Diversity",    col=cols2[immigrants], pch=pch2[immigrants])points(rep(-1, length(US_born_samples)), data[US_born_samples,"alphadiv"],bg=cols2[US_born_samples], pch=21, col="black")legend(pch=c(19,17), col=c("black","black","white","white"), x="topright", cex=.8, legend=c("Hmong", "Karen", "", ""))# add gradient image for age colorslegend_image <- as.raster(rbPal(10)[10:1])text(y=400, x = c(37,39,41), labels = c("17","BMI","43"), cex=c(.6,.8,.6))rasterImage(legend_image, 30.1, 400, 31.3, 410, angle=270)
plot(data[immigrants,"Years.in.US"], data[immigrants,"alphadiv"], xlab="Years in US", ylab="Number of Observed OTUs", main="Alpha Diversity",    col=cols2[immigrants], pch=pch2[immigrants])points(rep(-1, length(US_born_samples)), data[US_born_samples,"alphadiv"],bg=cols2[US_born_samples], pch=21, col="black")legend(pch=c(19,17), col=c("black","black","white","white"), x="topright", cex=.8, legend=c("Hmong", "Karen", "", ""))# add gradient image for age colorslegend_image <- as.raster(rbPal(10)[10:1])text(y=400, x = c(37.5,39.5,41.5), labels = c("17","BMI","43"), cex=c(.6,.8,.6))rasterImage(legend_image, 30.1, 400, 31.3, 410, angle=270)
plot(data[immigrants,"Years.in.US"], data[immigrants,"alphadiv"], xlab="Years in US", ylab="Number of Observed OTUs", main="Alpha Diversity",    col=cols2[immigrants], pch=pch2[immigrants])points(rep(-1, length(US_born_samples)), data[US_born_samples,"alphadiv"],bg=cols2[US_born_samples], pch=21, col="black")legend(pch=c(19,17), col=c("black","black","white","white"), x="topright", cex=.8, legend=c("Hmong", "Karen", "", ""))# add gradient image for age colorslegend_image <- as.raster(rbPal(10)[10:1])text(y=420, x = c(37.5,39.5,41.5), labels = c("17","BMI","43"), cex=c(.6,.8,.6))rasterImage(legend_image, 30.1, 400, 31.3, 410, angle=270)
plot(data[immigrants,"Years.in.US"], data[immigrants,"alphadiv"], xlab="Years in US", ylab="Number of Observed OTUs", main="Alpha Diversity",    col=cols2[immigrants], pch=pch2[immigrants])points(rep(-1, length(US_born_samples)), data[US_born_samples,"alphadiv"],bg=cols2[US_born_samples], pch=21, col="black")legend(pch=c(19,17), col=c("black","black","white","white"), x="topright", cex=.8, legend=c("Hmong", "Karen", "", ""))# add gradient image for age colorslegend_image <- as.raster(rbPal(10)[10:1])text(y=450, x = c(37.5,39.5,41.5), labels = c("17","BMI","43"), cex=c(.6,.8,.6))rasterImage(legend_image, 30.1, 400, 31.3, 410, angle=270)
plot(data[immigrants,"Years.in.US"], data[immigrants,"alphadiv"], xlab="Years in US", ylab="Number of Observed OTUs", main="Alpha Diversity",    col=cols2[immigrants], pch=pch2[immigrants])points(rep(-1, length(US_born_samples)), data[US_born_samples,"alphadiv"],bg=cols2[US_born_samples], pch=21, col="black")legend(pch=c(19,17), col=c("black","black","white","white"), x="topright", cex=.8, legend=c("Hmong", "Karen", "", ""))# add gradient image for age colorslegend_image <- as.raster(rbPal(10)[10:1])text(y=450, x = c(37.5,39.5,41.5), labels = c("17","BMI","43"), cex=c(.6,.8,.6))rasterImage(legend_image, 37, 445, 37.5, 450, angle=270)
plot(data[immigrants,"Years.in.US"], data[immigrants,"alphadiv"], xlab="Years in US", ylab="Number of Observed OTUs", main="Alpha Diversity",    col=cols2[immigrants], pch=pch2[immigrants])points(rep(-1, length(US_born_samples)), data[US_born_samples,"alphadiv"],bg=cols2[US_born_samples], pch=21, col="black")legend(pch=c(19,17), col=c("black","black","white","white"), x="topright", cex=.8, legend=c("Hmong", "Karen", "", ""))# add gradient image for age colorslegend_image <- as.raster(rbPal(10)[10:1])text(y=450, x = c(37.5,39.5,41.5), labels = c("17","BMI","43"), cex=c(.6,.8,.6))rasterImage(legend_image, 37, 445, 37.5, 460, angle=270)
plot(data[immigrants,"Years.in.US"], data[immigrants,"alphadiv"], xlab="Years in US", ylab="Number of Observed OTUs", main="Alpha Diversity",    col=cols2[immigrants], pch=pch2[immigrants])points(rep(-1, length(US_born_samples)), data[US_born_samples,"alphadiv"],bg=cols2[US_born_samples], pch=21, col="black")legend(pch=c(19,17), col=c("black","black","white","white"), x="topright", cex=.8, legend=c("Hmong", "Karen", "", ""))# add gradient image for age colorslegend_image <- as.raster(rbPal(10)[10:1])text(y=450, x = c(37.5,39.5,41.5), labels = c("17","BMI","43"), cex=c(.6,.8,.6))rasterImage(legend_image, 37, 445, 37.5, 470, angle=270)
plot(data[immigrants,"Years.in.US"], data[immigrants,"alphadiv"], xlab="Years in US", ylab="Number of Observed OTUs", main="Alpha Diversity",    col=cols2[immigrants], pch=pch2[immigrants])points(rep(-1, length(US_born_samples)), data[US_born_samples,"alphadiv"],bg=cols2[US_born_samples], pch=21, col="black")legend(pch=c(19,17), col=c("black","black","white","white"), x="topright", cex=.8, legend=c("Hmong", "Karen", "", ""))# add gradient image for age colorslegend_image <- as.raster(rbPal(10)[10:1])text(y=450, x = c(37.5,39.5,41.5), labels = c("17","BMI","43"), cex=c(.6,.8,.6))rasterImage(legend_image, 37, 445, 37.5, 490, angle=270)
plot(data[immigrants,"Years.in.US"], data[immigrants,"alphadiv"], xlab="Years in US", ylab="Number of Observed OTUs", main="Alpha Diversity",    col=cols2[immigrants], pch=pch2[immigrants])points(rep(-1, length(US_born_samples)), data[US_born_samples,"alphadiv"],bg=cols2[US_born_samples], pch=21, col="black")legend(pch=c(19,17), col=c("black","black","white","white"), x="topright", cex=.8, legend=c("Hmong", "Karen", "", ""))# add gradient image for age colorslegend_image <- as.raster(rbPal(10)[10:1])text(y=450, x = c(37.5,39.5,41.5), labels = c("17","BMI","43"), cex=c(.6,.8,.6))rasterImage(legend_image, 37, 445, 37.5, 490, angle=270)
plot(data[immigrants,"Years.in.US"], data[immigrants,"alphadiv"], xlab="Years in US", ylab="Number of Observed OTUs", main="Alpha Diversity",    col=cols2[immigrants], pch=pch2[immigrants])points(rep(-1, length(US_born_samples)), data[US_born_samples,"alphadiv"],bg=cols2[US_born_samples], pch=21, col="black")legend(pch=c(19,17), col=c("black","black","white","white"), x="topright", cex=.8, legend=c("Hmong", "Karen", "", ""))# add gradient image for age colorslegend_image <- as.raster(rbPal(10)[10:1])text(y=450, x = c(37.5,39.5,41.5), labels = c("17","BMI","43"), cex=c(.6,.8,.6))rasterImage(legend_image, 37, 445, 37.5, 495, angle=270)
plot(data[immigrants,"Years.in.US"], data[immigrants,"alphadiv"], xlab="Years in US", ylab="Number of Observed OTUs", main="Alpha Diversity",    col=cols2[immigrants], pch=pch2[immigrants])points(rep(-1, length(US_born_samples)), data[US_born_samples,"alphadiv"],bg=cols2[US_born_samples], pch=21, col="black")legend(pch=c(19,17), col=c("black","black","white","white"), x="topright", cex=.8, legend=c("Hmong", "Karen", "", ""))# add gradient image for age colorslegend_image <- as.raster(rbPal(10)[10:1])text(y=450, x = c(37.5,39.5,41.5), labels = c("17","BMI","43"), cex=c(.6,.8,.6))rasterImage(legend_image, 37, 445, 37.5, 492, angle=270)
alphadiv0 <- read.table("/Users/pvangay/Dropbox/UMN/KnightsLab/IMP/Sequencing/sequences_090716/4. EMBALMER_output/alpha_div_all.txt",    sep="\t", quote="", row=1, head=T, comment.char="")alphadiv <- alphadiv0[all_samples,"PD_whole_tree"]data <- cbind(map[all_samples, c("Years.in.US", "Ethnicity", "Age", "BMI","BMI.Class")], alphadiv)colnames(data) <- c("Years.in.US", "Ethnicity", "Age","BMI", "BMI.Class", "alphadiv")cols2 <- rbPal(10)[as.numeric(cut(data$BMI, breaks = 10))]names(cols2) <- rownames(data)pch2 <- lookup[as.character(data$Ethnicity)] names(pch2) <- rownames(data)plot(data[immigrants,"Years.in.US"], data[immigrants,"alphadiv"], xlab="Years in US", ylab="Number of Observed OTUs", main="Alpha Diversity",    col=cols2[immigrants], pch=pch2[immigrants])points(rep(-1, length(US_born_samples)), data[US_born_samples,"alphadiv"],bg=cols2[US_born_samples], pch=21, col="black")
data <- read.table("/Users/pvangay/Dropbox/UMN/KnightsLab/IMP/Sequencing/sequences_090716/4. EMBALMER_output/embalmer_cap.b6f", sep="_")queries <- read.table("/Users/pvangay/Dropbox/UMN/KnightsLab/IMP/Sequencing/sequences_090716/4. EMBALMER_output/filter_d5_headers2.txt", sep="_")data_table <- table(data[,1])queries_table <- table(queries[,1])fraction <- data_table/queries_table
head(fraction)
class(fraction)
dim(fraction)
write.table(fraction,"fraction_hitting_GG99.txt")
write.table(fraction,"fraction_hitting_GG99.txt",quote="",row.name=F,head=F)
?write.table
write.table(fraction,"fraction_hitting_GG99.txt",quote="",row.name=F,col.name=F)
write.table(fraction,"fraction_hitting_GG99.txt",quote=F,row.name=F,col.name=F)
imp_fraction <- fraction[all_samples]
cols2 <- rbPal(10)[as.numeric(cut(imp_fraction, breaks = 10))]names(cols2) <- rownames(data)pch2 <- lookup[as.character(data$Ethnicity)] names(pch2) <- rownames(data)plot(data[immigrants,"Years.in.US"], data[immigrants,"alphadiv"], xlab="Years in US", ylab="Number of Observed OTUs", main="Alpha Diversity",    col=cols2[immigrants], pch=pch2[immigrants])points(rep(-1, length(US_born_samples)), data[US_born_samples,"alphadiv"],bg=cols2[US_born_samples], pch=21, col="black")legend(pch=c(19,17), col=c("black","black","white","white"), x="topright", cex=.8, legend=c("Hmong", "Karen", "", ""))# add gradient image for age colorslegend_image <- as.raster(rbPal(10)[10:1])text(y=450, x = c(37.5,39.5,41.5), labels = c("17","BMI","43"), cex=c(.6,.8,.6))rasterImage(legend_image, 37, 445, 37.5, 492, angle=270)
cols2
all_samples
length(cols2)
dim(data)
all_samples <- rownames(map)[map$Ethnicity %in% c("Hmong","Karen")] immigrants <- rownames(map)[map$Ethnicity %in% c("Hmong","Karen") & map$Years.in.US!=0] alphadiv0 <- read.table("/Users/pvangay/Dropbox/UMN/KnightsLab/IMP/Sequencing/sequences_090716/4. EMBALMER_output/alpha_div_all.txt",    sep="\t", quote="", row=1, head=T, comment.char="")alphadiv <- alphadiv0[all_samples,"PD_whole_tree"]data <- cbind(map[all_samples, c("Years.in.US", "Ethnicity", "Age", "BMI","BMI.Class")], alphadiv)colnames(data) <- c("Years.in.US", "Ethnicity", "Age","BMI", "BMI.Class", "alphadiv")#cols2 <- rbPal(10)[as.numeric(cut(data$BMI, breaks = 10))]#names(cols2) <- rownames(data)cols2 <- rbPal(10)[as.numeric(cut(imp_fraction, breaks = 10))]names(cols2) <- rownames(data)pch2 <- lookup[as.character(data$Ethnicity)] names(pch2) <- rownames(data)plot(data[immigrants,"Years.in.US"], data[immigrants,"alphadiv"], xlab="Years in US", ylab="Number of Observed OTUs", main="Alpha Diversity",    col=cols2[immigrants], pch=pch2[immigrants])points(rep(-1, length(US_born_samples)), data[US_born_samples,"alphadiv"],bg=cols2[US_born_samples], pch=21, col="black")legend(pch=c(19,17), col=c("black","black","white","white"), x="topright", cex=.8, legend=c("Hmong", "Karen", "", ""))# add gradient image for age colorslegend_image <- as.raster(rbPal(10)[10:1])text(y=450, x = c(37.5,39.5,41.5), labels = c("17","BMI","43"), cex=c(.6,.8,.6))rasterImage(legend_image, 37, 445, 37.5, 492, angle=270)
alphadiv0 <- read.table("/Users/pvangay/Dropbox/UMN/KnightsLab/IMP/Sequencing/sequences_090716/4. EMBALMER_output/alpha_div_all.txt",    sep="\t", quote="", row=1, head=T, comment.char="")alphadiv <- alphadiv0[all_samples,"observed_otus"]data <- cbind(map[all_samples, c("Years.in.US", "Ethnicity", "Age", "BMI","BMI.Class")], alphadiv)colnames(data) <- c("Years.in.US", "Ethnicity", "Age","BMI", "BMI.Class", "alphadiv")#cols2 <- rbPal(10)[as.numeric(cut(data$BMI, breaks = 10))]#names(cols2) <- rownames(data)cols2 <- rbPal(10)[as.numeric(cut(imp_fraction, breaks = 10))]names(cols2) <- rownames(data)pch2 <- lookup[as.character(data$Ethnicity)] names(pch2) <- rownames(data)plot(data[immigrants,"Years.in.US"], data[immigrants,"alphadiv"], xlab="Years in US", ylab="Number of Observed OTUs", main="Alpha Diversity",    col=cols2[immigrants], pch=pch2[immigrants])points(rep(-1, length(US_born_samples)), data[US_born_samples,"alphadiv"],bg=cols2[US_born_samples], pch=21, col="black")legend(pch=c(19,17), col=c("black","black","white","white"), x="topright", cex=.8, legend=c("Hmong", "Karen", "", ""))# add gradient image for age colorslegend_image <- as.raster(rbPal(10)[10:1])text(y=450, x = c(37.5,39.5,41.5), labels = c("17","BMI","43"), cex=c(.6,.8,.6))rasterImage(legend_image, 37, 445, 37.5, 492, angle=270)
imp_fraction
min(imp_fraction)
max(imp_fraction)
plot(data[immigrants,"Years.in.US"], data[immigrants,"alphadiv"], xlab="Years in US", ylab="Number of Observed OTUs", main="Alpha Diversity",    col=cols2[immigrants], pch=pch2[immigrants])points(rep(-1, length(US_born_samples)), data[US_born_samples,"alphadiv"],bg=cols2[US_born_samples], pch=21, col="black")legend(pch=c(19,17), col=c("black","black","white","white"), x="topright", cex=.8, legend=c("Hmong", "Karen", "", ""))# add gradient image for age colorslegend_image <- as.raster(rbPal(10)[10:1])text(y=450, x = c(37.5,39.5,41.5), labels = c("50%","Hits","70%"), cex=c(.6,.8,.6))rasterImage(legend_image, 37, 445, 37.5, 492, angle=270)
plot(data[immigrants,"Years.in.US"], data[immigrants,"alphadiv"], xlab="Years in US", ylab="Number of Observed OTUs", main="Alpha Diversity",    col=cols2[immigrants], pch=pch2[immigrants])points(rep(-1, length(US_born_samples)), data[US_born_samples,"alphadiv"],bg=cols2[US_born_samples], pch=21, col="black")legend(pch=c(19,17), col=c("black","black","white","white"), x="topright", cex=.8, legend=c("Hmong", "Karen", "", ""))# add gradient image for age colorslegend_image <- as.raster(rbPal(10)[10:1])text(y=450, x = c(37.5,39.5,41.5), labels = c(".5","Hits",".7"), cex=c(.6,.8,.6))rasterImage(legend_image, 37, 445, 37.5, 492, angle=270)
plot(data[immigrants,"Years.in.US"], data[immigrants,"alphadiv"], xlab="Years in US", ylab="Number of Observed OTUs", main="Alpha Diversity",    col=cols2[immigrants], pch=pch2[immigrants])points(rep(-1, length(US_born_samples)), data[US_born_samples,"alphadiv"],bg=cols2[US_born_samples], pch=21, col="black")legend(pch=c(19,17), col=c("black","black","white","white"), x="topright", cex=.8, legend=c("Hmong", "Karen", "", ""))# add gradient image for age colorslegend_image <- as.raster(rbPal(10)[10:1])text(y=450, x = c(37,39.5,41), labels = c("50%","Hits","70%"), cex=c(.6,.8,.6))rasterImage(legend_image, 37, 445, 37.5, 492, angle=270)
plot(data[immigrants,"Years.in.US"], data[immigrants,"alphadiv"], xlab="Years in US", ylab="Number of Observed OTUs", main="Alpha Diversity",    col=cols2[immigrants], pch=pch2[immigrants])points(rep(-1, length(US_born_samples)), data[US_born_samples,"alphadiv"],bg=cols2[US_born_samples], pch=21, col="black")legend(pch=c(19,17), col=c("black","black","white","white"), x="topright", cex=.8, legend=c("Hmong", "Karen", "", ""))# add gradient image for age colorslegend_image <- as.raster(rbPal(10)[10:1])text(y=450, x = c(37.52,39.5,41.25), labels = c("50%","Hits","70%"), cex=c(.6,.8,.6))rasterImage(legend_image, 37, 445, 37.5, 492, angle=270)
plot(data[immigrants,"Years.in.US"], data[immigrants,"alphadiv"], xlab="Years in US", ylab="Number of Observed OTUs", main="Alpha Diversity",    col=cols2[immigrants], pch=pch2[immigrants])points(rep(-1, length(US_born_samples)), data[US_born_samples,"alphadiv"],bg=cols2[US_born_samples], pch=21, col="black")legend(pch=c(19,17), col=c("black","black","white","white"), x="topright", cex=.8, legend=c("Hmong", "Karen", "", ""))# add gradient image for age colorslegend_image <- as.raster(rbPal(10)[10:1])text(y=450, x = c(37.52,39.5,41.45), labels = c("50%","Hits","70%"), cex=c(.6,.8,.6))rasterImage(legend_image, 37, 445, 37.5, 492, angle=270)
